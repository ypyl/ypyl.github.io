<html><head><link rel="stylesheet" href="./ace_editor.css"/></head><body>
<section class="rc-CourseReferencesPage"><h1 class="tab-headline"><span>Week 5 Lecture Notes </span></h1><div class="rc-CML styled"><div><h1>ML:Neural Networks: Learning</h1><h1>Cost Function</h1><p>Let's first define a few variables that we will need to use:</p><p>a) L= total number of layers in the network</p><p>b) <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-982-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-30741"><span style="display: inline-block; position: relative; width: 11px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(30.3px 17360px 46.7px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-30742"><span class="msubsup" id="MathJax-Span-30743"><span style="display: inline-block; position: relative; width: 11.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-30744" style="font-family: STIXGeneral; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7px;"><span class="mi" id="MathJax-Span-30745" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.4px; vertical-align: -3.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-982">s_l</script> = number of units (not counting bias unit) in layer l</p><p>c) K= number of output units/classes</p><p>Recall that in neural networks, we may have many output nodes. We denote <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-983-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-30746"><span style="display: inline-block; position: relative; width: 46px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.1px 17360px 50.8px -8.7px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-30747"><span class="msubsup" id="MathJax-Span-30748"><span style="display: inline-block; position: relative; width: 19.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-30749" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="mi" id="MathJax-Span-30750" style="font-size: 70.7%; font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-30751" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30752" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="msubsup" id="MathJax-Span-30753"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-30754" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -38.3px; left: 6px;"><span class="mi" id="MathJax-Span-30755" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.7px; vertical-align: -4.8px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-983">h_\Theta(x)_k</script> as being a hypothesis that results in the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-984-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-30756"><span style="display: inline-block; position: relative; width: 20px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.5px 17360px 44.2px -8.8px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-30757"><span class="msubsup" id="MathJax-Span-30758"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.8px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-30759" style="font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.1px; left: 9px;"><span class="texatom" id="MathJax-Span-30760"><span class="mrow" id="MathJax-Span-30761"><span class="mi" id="MathJax-Span-30762" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mi" id="MathJax-Span-30763" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.7px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-984">k^{th}</script> output.</p><p>Our cost function for neural networks is going to be a generalization of the one we used for logistic regression.</p><p>Recall that the cost function for regularized logistic regression was:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-985-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-30764"><span style="display: inline-block; position: relative; width: 657px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.3px 17360px 66.4px -9.1px); top: -53px; left: 0px;"><span class="mrow" id="MathJax-Span-30765"><span class="mi" id="MathJax-Span-30766" style="font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-30767" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30768" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-30769" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-30770" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-30771" style="font-family: STIXGeneral; padding-left: 5.4px;">−</span><span class="mfrac" id="MathJax-Span-30772" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45px -7.6px); top: -49.3px; left: 50%; margin-left: -3px;"><span class="mn" id="MathJax-Span-30773" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.9px); top: -36px; left: 50%; margin-left: -4.5px;"><span class="mi" id="MathJax-Span-30774" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="munderover" id="MathJax-Span-30775" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 35.3px; height: 0px;"><span style="position: absolute; clip: rect(27.8px 17360px 51.5px -8px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-30776" style="font-family: STIXGeneral; vertical-align: 0px;">∑</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.9px); top: -50.5px; left: 16px;"><span class="mi" id="MathJax-Span-30777" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.4px); top: -36.9px; left: 16px;"><span class="texatom" id="MathJax-Span-30778"><span class="mrow" id="MathJax-Span-30779"><span class="mi" id="MathJax-Span-30780" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30781" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-30782" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mstyle" id="MathJax-Span-30783"><span class="mrow" id="MathJax-Span-30784"><span class="mo" id="MathJax-Span-30785" style="font-size: 135%; font-family: STIXGeneral;">[</span><span class="msubsup" id="MathJax-Span-30786"><span style="display: inline-block; position: relative; width: 27.3px; height: 0px;"><span style="position: absolute; clip: rect(39.7px 17360px 60.8px -9.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30787" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -50.3px; left: 10px;"><span class="texatom" id="MathJax-Span-30788"><span class="mrow" id="MathJax-Span-30789"><span class="mo" id="MathJax-Span-30790" style="font-size: 95.5%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30791" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30792" style="font-size: 95.5%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mtext" id="MathJax-Span-30793" style="font-size: 135%; font-family: STIXGeneral;">&nbsp;</span><span class="mi" id="MathJax-Span-30794" style="font-size: 135%; font-family: STIXGeneral; padding-left: 2.4px;">log</span><span class="mo" id="MathJax-Span-30795" style="font-size: 135%;"></span><span class="mo" id="MathJax-Span-30796" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-30797"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(34px 17360px 56.2px -8.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30798" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -38.7px; left: 12px;"><span class="mi" id="MathJax-Span-30799" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30800" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-30801"><span style="display: inline-block; position: relative; width: 28.2px; height: 0px;"><span style="position: absolute; clip: rect(39.7px 17360px 56.3px -9.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30802" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -50.3px; left: 10.9px;"><span class="texatom" id="MathJax-Span-30803"><span class="mrow" id="MathJax-Span-30804"><span class="mo" id="MathJax-Span-30805" style="font-size: 95.5%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30806" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30807" style="font-size: 95.5%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30808" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-30809" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-30810" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">+</span><span class="mo" id="MathJax-Span-30811" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">(</span><span class="mn" id="MathJax-Span-30812" style="font-size: 135%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-30813" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">−</span><span class="msubsup" id="MathJax-Span-30814" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 27.3px; height: 0px;"><span style="position: absolute; clip: rect(39.7px 17360px 60.8px -9.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30815" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -50.3px; left: 10px;"><span class="texatom" id="MathJax-Span-30816"><span class="mrow" id="MathJax-Span-30817"><span class="mo" id="MathJax-Span-30818" style="font-size: 95.5%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30819" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30820" style="font-size: 95.5%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30821" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="mtext" id="MathJax-Span-30822" style="font-size: 135%; font-family: STIXGeneral;">&nbsp;</span><span class="mi" id="MathJax-Span-30823" style="font-size: 135%; font-family: STIXGeneral; padding-left: 2.4px;">log</span><span class="mo" id="MathJax-Span-30824" style="font-size: 135%;"></span><span class="mo" id="MathJax-Span-30825" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-30826" style="font-size: 135%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-30827" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">−</span><span class="msubsup" id="MathJax-Span-30828" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(34px 17360px 56.2px -8.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30829" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -38.7px; left: 12px;"><span class="mi" id="MathJax-Span-30830" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30831" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-30832"><span style="display: inline-block; position: relative; width: 28.2px; height: 0px;"><span style="position: absolute; clip: rect(39.7px 17360px 56.3px -9.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30833" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -50.3px; left: 10.9px;"><span class="texatom" id="MathJax-Span-30834"><span class="mrow" id="MathJax-Span-30835"><span class="mo" id="MathJax-Span-30836" style="font-size: 95.5%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30837" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30838" style="font-size: 95.5%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30839" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-30840" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="mstyle" id="MathJax-Span-30841"><span class="mrow" id="MathJax-Span-30842"><span class="mo" id="MathJax-Span-30843" style="font-size: 135%; font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-30844" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">+</span><span class="mfrac" id="MathJax-Span-30845" style="padding-left: 6.4px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 22.1px; height: 0px;"><span style="position: absolute; clip: rect(29.8px 17360px 47.3px -9.2px); top: -51.5px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-30846" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.8px 17360px 47.1px -8.5px); top: -34.2px; left: 50%; margin-left: -10px;"><span class="mrow" id="MathJax-Span-30847"><span class="mn" id="MathJax-Span-30848" style="font-size: 95.5%; font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-30849" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 22.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="munderover" id="MathJax-Span-30850" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 46.3px; height: 0px;"><span style="position: absolute; clip: rect(32.2px 17360px 62.1px -7.6px); top: -53px; left: 0px;"><span class="mo" id="MathJax-Span-30851" style="font-size: 135%; font-family: STIXGeneral; vertical-align: 0px;">∑</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(33.7px 17360px 47.1px -8.8px); top: -55.4px; left: 21px;"><span class="mi" id="MathJax-Span-30852" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.8px 17360px 50.4px -11.1px); top: -37.1px; left: 21px;"><span class="texatom" id="MathJax-Span-30853"><span class="mrow" id="MathJax-Span-30854"><span class="mi" id="MathJax-Span-30855" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-30856" style="font-size: 95.5%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-30857" style="font-size: 95.5%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-30858" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(34.1px 17360px 56.3px -8.4px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30859" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(29.8px 17360px 47px -8.5px); top: -53.5px; left: 13px;"><span class="mn" id="MathJax-Span-30860" style="font-size: 95.5%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.2px 17360px 50.4px -11.1px); top: -39.6px; left: 11.7px;"><span class="mi" id="MathJax-Span-30861" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 33.1px; vertical-align: -11.4px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-985">J(\theta) = - \frac{1}{m} \sum_{i=1}^m \large[ y^{(i)}\ \log (h_\theta (x^{(i)})) + (1 - y^{(i)})\ \log (1 - h_\theta(x^{(i)}))\large] + \frac{\lambda}{2m}\sum_{j=1}^n \theta_j^2</script></td></tr></tbody></table><p>For neural networks, it is going to be slightly more complicated:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-986-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-30862"><span style="display: inline-block; position: relative; width: 860px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-1.6px 17360px 74.9px -6.2px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-30863"><span class="mtable" id="MathJax-Span-30864" style="padding-right: 2.9px; padding-left: 2.9px;"><span style="display: inline-block; position: relative; width: 856px; height: 0px;"><span style="position: absolute; clip: rect(45.4px 17360px 121.9px -9.1px); top: -88px; left: 0px;"><span style="display: inline-block; position: relative; width: 856px; height: 0px;"><span style="position: absolute; clip: rect(24.3px 17360px 100.8px -9.1px); top: -66.9px; left: 50%; margin-left: -428px;"><span class="mtd" id="MathJax-Span-30865"><span class="mrow" id="MathJax-Span-30866"><span class="mstyle" id="MathJax-Span-30867"><span class="mrow" id="MathJax-Span-30868"><span class="mi" id="MathJax-Span-30869" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 1.1px;"></span></span><span class="mo" id="MathJax-Span-30870" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30871" style="font-size: 135%; font-family: STIXGeneral;">Θ</span><span class="mo" id="MathJax-Span-30872" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-30873" style="font-size: 135%; font-family: STIXGeneral; padding-left: 4px;">=</span><span class="mo" id="MathJax-Span-30874" style="font-size: 135%; font-family: STIXGeneral; padding-left: 4px;">−</span><span class="mfrac" id="MathJax-Span-30875" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 19.1px; height: 0px;"><span style="position: absolute; clip: rect(34.2px 17360px 56px -6.4px); top: -64.7px; left: 50%; margin-left: -6px;"><span class="mn" id="MathJax-Span-30876" style="font-size: 135%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(39.7px 17360px 56.2px -8.7px); top: -41.1px; left: 50%; margin-left: -8.5px;"><span class="mi" id="MathJax-Span-30877" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 19.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="munderover" id="MathJax-Span-30878" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 30px; height: 0px;"><span style="position: absolute; clip: rect(37.1px 17360px 77.1px -6.9px); top: -63px; left: 0px;"><span class="mo" id="MathJax-Span-30879" style="font-size: 135%; font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 63px;"></span></span><span style="position: absolute; clip: rect(29.8px 17360px 48.9px -8.2px); top: -18.4px; left: 3px;"><span class="texatom" id="MathJax-Span-30880"><span class="mrow" id="MathJax-Span-30881"><span class="mi" id="MathJax-Span-30882" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30883" style="font-size: 95.5%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-30884" style="font-size: 95.5%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(32px 17360px 47.1px -8.8px); top: -70.8px; left: 9px;"><span class="mi" id="MathJax-Span-30885" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="munderover" id="MathJax-Span-30886" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 30px; height: 0px;"><span style="position: absolute; clip: rect(37.1px 17360px 77.1px -6.9px); top: -63px; left: 0px;"><span class="mo" id="MathJax-Span-30887" style="font-size: 135%; font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 63px;"></span></span><span style="position: absolute; clip: rect(29.7px 17360px 48.9px -8.8px); top: -18.3px; left: 1.5px;"><span class="texatom" id="MathJax-Span-30888"><span class="mrow" id="MathJax-Span-30889"><span class="mi" id="MathJax-Span-30890" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-30891" style="font-size: 95.5%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-30892" style="font-size: 95.5%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(28.4px 17360px 47px -8.9px); top: -70.8px; left: 9px;"><span class="mi" id="MathJax-Span-30893" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mfenced" id="MathJax-Span-30894"><span class="mo" id="MathJax-Span-34213" style="vertical-align: -7.3px;"><span><span style="font-size: 148.5%; font-family: STIXSizeOneSym;">[</span></span></span><span class="mrow" id="MathJax-Span-30896"><span class="msubsup" id="MathJax-Span-30897"><span style="display: inline-block; position: relative; width: 27.3px; height: 0px;"><span style="position: absolute; clip: rect(39.7px 17360px 60.8px -9.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30898" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(29.8px 17360px 49.9px -8.2px); top: -52.9px; left: 10px;"><span class="texatom" id="MathJax-Span-30899"><span class="mrow" id="MathJax-Span-30900"><span class="mo" id="MathJax-Span-30901" style="font-size: 95.5%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30902" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30903" style="font-size: 95.5%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.7px 17360px 47.2px -8.8px); top: -35.5px; left: 10px;"><span class="mi" id="MathJax-Span-30904" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mi" id="MathJax-Span-30905" style="font-size: 135%; font-family: STIXGeneral; padding-left: 2.4px;">log</span><span class="mo" id="MathJax-Span-30906" style="font-size: 135%;"></span><span class="mo" id="MathJax-Span-30907" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-30908" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-30909"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(34px 17360px 56.2px -8.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30910" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -38.8px; left: 12px;"><span class="mi" id="MathJax-Span-30911" style="font-size: 95.5%; font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30912" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-30913"><span style="display: inline-block; position: relative; width: 28.2px; height: 0px;"><span style="position: absolute; clip: rect(39.7px 17360px 56.3px -9.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30914" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -51.2px; left: 10.9px;"><span class="texatom" id="MathJax-Span-30915"><span class="mrow" id="MathJax-Span-30916"><span class="mo" id="MathJax-Span-30917" style="font-size: 95.5%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30918" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30919" style="font-size: 95.5%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30920" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="msubsup" id="MathJax-Span-30921"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(34.2px 17360px 60.1px -8.3px); top: -53px; left: 0px;"><span class="mo" id="MathJax-Span-30922" style="font-size: 135%; font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -38.7px; left: 8px;"><span class="mi" id="MathJax-Span-30923" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30924" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-30925" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">+</span><span class="mo" id="MathJax-Span-30926" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">(</span><span class="mn" id="MathJax-Span-30927" style="font-size: 135%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-30928" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">−</span><span class="msubsup" id="MathJax-Span-30929" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 27.3px; height: 0px;"><span style="position: absolute; clip: rect(39.7px 17360px 60.8px -9.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30930" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(29.8px 17360px 49.9px -8.2px); top: -52.9px; left: 10px;"><span class="texatom" id="MathJax-Span-30931"><span class="mrow" id="MathJax-Span-30932"><span class="mo" id="MathJax-Span-30933" style="font-size: 95.5%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30934" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30935" style="font-size: 95.5%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.7px 17360px 47.2px -8.8px); top: -35.5px; left: 10px;"><span class="mi" id="MathJax-Span-30936" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30937" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-30938" style="font-size: 135%; font-family: STIXGeneral; padding-left: 2.4px;">log</span><span class="mo" id="MathJax-Span-30939" style="font-size: 135%;"></span><span class="mo" id="MathJax-Span-30940" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-30941" style="font-size: 135%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-30942" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">−</span><span class="mo" id="MathJax-Span-30943" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">(</span><span class="msubsup" id="MathJax-Span-30944"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(34px 17360px 56.2px -8.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30945" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -38.8px; left: 12px;"><span class="mi" id="MathJax-Span-30946" style="font-size: 95.5%; font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30947" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-30948"><span style="display: inline-block; position: relative; width: 28.2px; height: 0px;"><span style="position: absolute; clip: rect(39.7px 17360px 56.3px -9.6px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-30949" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -51.2px; left: 10.9px;"><span class="texatom" id="MathJax-Span-30950"><span class="mrow" id="MathJax-Span-30951"><span class="mo" id="MathJax-Span-30952" style="font-size: 95.5%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-30953" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30954" style="font-size: 95.5%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30955" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="msubsup" id="MathJax-Span-30956"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(34.2px 17360px 60.1px -8.3px); top: -53px; left: 0px;"><span class="mo" id="MathJax-Span-30957" style="font-size: 135%; font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -38.7px; left: 8px;"><span class="mi" id="MathJax-Span-30958" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-30959" style="font-size: 135%; font-family: STIXGeneral;">)</span></span><span class="mo" id="MathJax-Span-34214" style="vertical-align: -7.3px;"><span><span style="font-size: 148.5%; font-family: STIXSizeOneSym;">]</span></span></span></span><span class="mo" id="MathJax-Span-30961" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">+</span><span class="mfrac" id="MathJax-Span-30962" style="padding-left: 6.4px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 31.1px; height: 0px;"><span style="position: absolute; clip: rect(34.1px 17360px 56.4px -9.3px); top: -64.7px; left: 50%; margin-left: -5.5px;"><span class="mi" id="MathJax-Span-30963" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(34.2px 17360px 56.2px -8.3px); top: -37.4px; left: 50%; margin-left: -14.5px;"><span class="mrow" id="MathJax-Span-30964"><span class="mn" id="MathJax-Span-30965" style="font-size: 135%; font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-30966" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 31.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="munderover" id="MathJax-Span-30967" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 30px; height: 0px;"><span style="position: absolute; clip: rect(37.1px 17360px 77.1px -6.9px); top: -63px; left: 0px;"><span class="mo" id="MathJax-Span-30968" style="font-size: 135%; font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 63px;"></span></span><span style="position: absolute; clip: rect(29.7px 17360px 48.9px -8.3px); top: -18.3px; left: 3px;"><span class="texatom" id="MathJax-Span-30969"><span class="mrow" id="MathJax-Span-30970"><span class="mi" id="MathJax-Span-30971" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-30972" style="font-size: 95.5%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-30973" style="font-size: 95.5%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(28.1px 17360px 47px -9.1px); top: -70.8px; left: 0.5px;"><span class="texatom" id="MathJax-Span-30974"><span class="mrow" id="MathJax-Span-30975"><span class="mi" id="MathJax-Span-30976" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-30977" style="font-size: 95.5%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-30978" style="font-size: 95.5%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="munderover" id="MathJax-Span-30979" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 30px; height: 0px;"><span style="position: absolute; clip: rect(37.1px 17360px 77.1px -6.9px); top: -63px; left: 0px;"><span class="mo" id="MathJax-Span-30980" style="font-size: 135%; font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 63px;"></span></span><span style="position: absolute; clip: rect(29.8px 17360px 48.9px -8.2px); top: -18.4px; left: 3px;"><span class="texatom" id="MathJax-Span-30981"><span class="mrow" id="MathJax-Span-30982"><span class="mi" id="MathJax-Span-30983" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-30984" style="font-size: 95.5%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-30985" style="font-size: 95.5%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(56.9px 17360px 75.9px -8.7px); top: -97.9px; left: 10px;"><span class="texatom" id="MathJax-Span-30986"><span class="mrow" id="MathJax-Span-30987"><span class="msubsup" id="MathJax-Span-30988"><span style="display: inline-block; position: relative; width: 9.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-30989" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.2px; left: 6px;"><span class="mi" id="MathJax-Span-30990" style="font-size: 67.5%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="munderover" id="MathJax-Span-30991" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 30px; height: 0px;"><span style="position: absolute; clip: rect(37.1px 17360px 77.1px -6.9px); top: -63px; left: 0px;"><span class="mo" id="MathJax-Span-30992" style="font-size: 135%; font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 63px;"></span></span><span style="position: absolute; clip: rect(29.8px 17360px 52.2px -11.1px); top: -18.4px; left: 3px;"><span class="texatom" id="MathJax-Span-30993"><span class="mrow" id="MathJax-Span-30994"><span class="mi" id="MathJax-Span-30995" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-30996" style="font-size: 95.5%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-30997" style="font-size: 95.5%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(56.9px 17360px 76.3px -8.7px); top: -98.3px; left: 3px;"><span class="texatom" id="MathJax-Span-30998"><span class="mrow" id="MathJax-Span-30999"><span class="msubsup" id="MathJax-Span-31000"><span style="display: inline-block; position: relative; width: 23.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31001" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.2px; left: 6px;"><span class="texatom" id="MathJax-Span-31002"><span class="mrow" id="MathJax-Span-31003"><span class="mi" id="MathJax-Span-31004" style="font-size: 67.5%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31005" style="font-size: 67.5%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31006" style="font-size: 67.5%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="mo" id="MathJax-Span-31007" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31008"><span style="display: inline-block; position: relative; width: 34.3px; height: 0px;"><span style="position: absolute; clip: rect(34.2px 17360px 56.3px -8.2px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-31009" style="font-size: 135%; font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(29.7px 17360px 49.9px -8.2px); top: -55.1px; left: 17px;"><span class="texatom" id="MathJax-Span-31010"><span class="mrow" id="MathJax-Span-31011"><span class="mo" id="MathJax-Span-31012" style="font-size: 95.5%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31013" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31014" style="font-size: 95.5%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.2px 17360px 50.4px -11.1px); top: -38.2px; left: 17px;"><span class="texatom" id="MathJax-Span-31015"><span class="mrow" id="MathJax-Span-31016"><span class="mi" id="MathJax-Span-31017" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31018" style="font-size: 95.5%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31019" style="font-size: 95.5%; font-family: STIXGeneral; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31020"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(34.2px 17360px 60.1px -8.3px); top: -53px; left: 0px;"><span class="mo" id="MathJax-Span-31021" style="font-size: 135%; font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -53.4px; left: 8px;"><span class="mn" id="MathJax-Span-31022" style="font-size: 95.5%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 67px;"></span></span></span><span style="display: inline-block; width: 0px; height: 88px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 72.5px; vertical-align: -31.9px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-986">\begin{gather*}\large J(\Theta) = - \frac{1}{m} \sum_{i=1}^m \sum_{k=1}^K \left[y^{(i)}_k \log ((h_\Theta (x^{(i)}))_k) + (1 - y^{(i)}_k)\log (1 - (h_\Theta(x^{(i)}))_k)\right] + \frac{\lambda}{2m}\sum_{l=1}^{L-1} \sum_{i=1}^{s_l} \sum_{j=1}^{s_{l+1}} ( \Theta_{j,i}^{(l)})^2\end{gather*}</script></td></tr></tbody></table><p>We have added a few nested summations to account for our multiple output nodes. In the first part of the equation, between the square brackets, we have an additional nested summation that loops through the number of output nodes.</p><p>In the regularization part, after the square brackets, we must account for multiple theta matrices. The number of columns in our current theta matrix is equal to the number of nodes in our current layer (including the bias unit). The number of rows in our current theta matrix is equal to the number of nodes in the next layer (excluding the bias unit). As before with logistic regression, we square every term.</p><p>Note:</p><ul><li>the double sum simply adds up the logistic regression costs calculated for each cell in the output layer; and</li><li>the triple sum simply adds up the squares of all the individual Θs in the entire network.</li><li>the i in the triple sum does <strong>not</strong> refer to training example i</li></ul><h1>Backpropagation Algorithm</h1><p>"Backpropagation" is neural-network terminology for minimizing our cost function, just like what we were doing with gradient descent in logistic and linear regression.</p><p>Our goal is to compute:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-987-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31023"><span style="display: inline-block; position: relative; width: 73px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.1px 17360px 50.1px -8.7px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31024"><span class="munderover" id="MathJax-Span-31025"><span style="display: inline-block; position: relative; width: 37.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47px -8.7px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-31026" style="font-family: STIXGeneral;">min</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 27px;"><span class="mi" id="MathJax-Span-31027" style="font-size: 70.7%; font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mi" id="MathJax-Span-31028" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-31029" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31030" style="font-family: STIXGeneral;">Θ</span><span class="mo" id="MathJax-Span-31031" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.9px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-987">\min_\Theta J(\Theta)</script></p><p>That is, we want to minimize our cost function J using an optimal set of parameters in theta.</p><p>In this section we'll look at the equations we use to compute the partial derivative of J(Θ):</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-988-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31032"><span style="display: inline-block; position: relative; width: 76px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(17.7px 17360px 71px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31033"><span class="mstyle" id="MathJax-Span-31034"><span class="mrow" id="MathJax-Span-31035"><span class="mfrac" id="MathJax-Span-31036" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.3px); top: -55.7px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-31037" style="font-family: STIXGeneral;">∂</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(24.5px 17360px 54.7px -8.3px); top: -27.7px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-31038"><span class="mi" id="MathJax-Span-31039" style="font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-31040"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31041" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31042"><span class="mrow" id="MathJax-Span-31043"><span class="mo" id="MathJax-Span-31044" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31045" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31046" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31047"><span class="mrow" id="MathJax-Span-31048"><span class="mi" id="MathJax-Span-31049" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31050" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31051" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-31052" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-31053" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31054" style="font-family: STIXGeneral;">Θ</span><span class="mo" id="MathJax-Span-31055" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 49.3px; vertical-align: -25px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-988">\dfrac{\partial}{\partial \Theta_{i,j}^{(l)}}J(\Theta)</script></p><p>In back propagation we're going to compute for every node:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-989-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31056"><span style="display: inline-block; position: relative; width: 21px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(21.5px 17360px 51.7px -8.6px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31057"><span class="msubsup" id="MathJax-Span-31058"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31059" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 8px;"><span class="texatom" id="MathJax-Span-31060"><span class="mrow" id="MathJax-Span-31061"><span class="mo" id="MathJax-Span-31062" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31063" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31064" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 8px;"><span class="mi" id="MathJax-Span-31065" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 26.2px; vertical-align: -8.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-989">\delta_j^{(l)}</script> = "error" of node j in layer l</p><p>Recall that <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-990-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31066"><span style="display: inline-block; position: relative; width: 22px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(21.5px 17360px 51.7px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31067"><span class="msubsup" id="MathJax-Span-31068"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31069" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 9px;"><span class="texatom" id="MathJax-Span-31070"><span class="mrow" id="MathJax-Span-31071"><span class="mo" id="MathJax-Span-31072" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31073" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31074" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 9px;"><span class="mi" id="MathJax-Span-31075" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 26.2px; vertical-align: -8.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-990">a_j^{(l)}</script> is activation node j in layer l.</p><p>For the <strong>last layer</strong>, we can compute the vector of delta values with:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-991-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31076"><span style="display: inline-block; position: relative; width: 99px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.8px 17360px 50.6px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31077"><span class="msubsup" id="MathJax-Span-31078"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31079" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31080"><span class="mrow" id="MathJax-Span-31081"><span class="mo" id="MathJax-Span-31082" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31083" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31084" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31085" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-31086" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31087" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31088"><span class="mrow" id="MathJax-Span-31089"><span class="mo" id="MathJax-Span-31090" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31091" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31092" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31093" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-31094" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">y</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.7px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-991">\delta^{(L)} = a^{(L)} - y</script></p><p>Where L is our total number of layers and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-992-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31095"><span style="display: inline-block; position: relative; width: 25px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.4px 17360px 44.2px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31096"><span class="msubsup" id="MathJax-Span-31097"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31098" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31099"><span class="mrow" id="MathJax-Span-31100"><span class="mo" id="MathJax-Span-31101" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31102" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31103" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-992">a^{(L)}</script> is the vector of outputs of the activation units for the last layer. So our "error values" for the last layer are simply the differences of our actual results in the last layer and the correct outputs in y.</p><p>To get the delta values of the layers before the last layer, we can use an equation that steps us back from right to left:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-993-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31104"><span style="display: inline-block; position: relative; width: 209px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.6px 17360px 50.6px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31105"><span class="msubsup" id="MathJax-Span-31106"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31107" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31108"><span class="mrow" id="MathJax-Span-31109"><span class="mo" id="MathJax-Span-31110" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31111" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31112" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31113" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-31114" style="font-family: STIXGeneral; padding-left: 5.4px;">(</span><span class="mo" id="MathJax-Span-31115" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31116"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31117" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 13px;"><span class="texatom" id="MathJax-Span-31118"><span class="mrow" id="MathJax-Span-31119"><span class="mo" id="MathJax-Span-31120" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31121" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31122" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31123"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-31124" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="mi" id="MathJax-Span-31125" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31126"><span style="display: inline-block; position: relative; width: 35.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31127" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31128"><span class="mrow" id="MathJax-Span-31129"><span class="mo" id="MathJax-Span-31130" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31131" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31132" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31133" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31134" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31135" style="font-family: STIXGeneral;">)</span><span class="mtext" id="MathJax-Span-31136" style="font-family: STIXGeneral;">&nbsp;</span><span class="mo" id="MathJax-Span-31137" style="font-family: STIXGeneral;">.</span><span class="mo" id="MathJax-Span-31138" style="font-family: STIXGeneral; padding-left: 3.3px;">∗</span><span class="mtext" id="MathJax-Span-31139" style="font-family: STIXGeneral;">&nbsp;</span><span class="msup" id="MathJax-Span-31140"><span style="display: inline-block; position: relative; width: 14.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -8.9px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31141" style="font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="mo" id="MathJax-Span-31142" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31143" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31144"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 48.4px -9px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31145" style="font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 7px;"><span class="texatom" id="MathJax-Span-31146"><span class="mrow" id="MathJax-Span-31147"><span class="mo" id="MathJax-Span-31148" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31149" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31150" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31151" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 21px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-993">\delta^{(l)} = ((\Theta^{(l)})^T \delta^{(l+1)})\ .*\ g'(z^{(l)})</script></td></tr></tbody></table><p>The delta values of layer l are calculated by multiplying the delta values in the next layer with the theta matrix of layer l. We then element-wise multiply that with a function called g', or g-prime, which is the derivative of the activation function g evaluated with the input values given by z(l).</p><p>The g-prime derivative terms can also be written out as:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-994-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31152"><span style="display: inline-block; position: relative; width: 178px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.3px 17360px 50.6px -8.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31153"><span class="msup" id="MathJax-Span-31154"><span style="display: inline-block; position: relative; width: 14.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -8.9px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31155" style="font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="mo" id="MathJax-Span-31156" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31157" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31158"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 48.4px -9px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31159" style="font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 7px;"><span class="texatom" id="MathJax-Span-31160"><span class="mrow" id="MathJax-Span-31161"><span class="mo" id="MathJax-Span-31162" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31163" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31164" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31165" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-31166" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-31167" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31168" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31169"><span class="mrow" id="MathJax-Span-31170"><span class="mo" id="MathJax-Span-31171" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31172" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31173" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mtext" id="MathJax-Span-31174" style="font-family: STIXGeneral;">&nbsp;</span><span class="mo" id="MathJax-Span-31175" style="font-family: STIXGeneral;">.</span><span class="mo" id="MathJax-Span-31176" style="font-family: STIXGeneral; padding-left: 3.3px;">∗</span><span class="mtext" id="MathJax-Span-31177" style="font-family: STIXGeneral;">&nbsp;</span><span class="mo" id="MathJax-Span-31178" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-31179" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31180" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-31181" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31182" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31183"><span class="mrow" id="MathJax-Span-31184"><span class="mo" id="MathJax-Span-31185" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31186" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31187" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31188" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.3px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-994">g'(z^{(l)}) = a^{(l)}\ .*\ (1 - a^{(l)})</script></td></tr></tbody></table><p>This can be shown and proved in calculus.</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-995-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31189"><span style="display: inline-block; position: relative; width: 84px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.4px 17360px 54.4px -8.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31190"><span class="mi" id="MathJax-Span-31191" style="font-family: STIXGeneral; font-style: italic;">g</span><span class="mo" id="MathJax-Span-31192" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31193" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-31194" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-31195" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mfrac" id="MathJax-Span-31196" style="padding-left: 7.5px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 31.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45px -7.6px); top: -49.3px; left: 50%; margin-left: -3px;"><span class="mn" id="MathJax-Span-31197" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45.5px -7.6px); top: -35.1px; left: 50%; margin-left: -14.5px;"><span class="mrow" id="MathJax-Span-31198"><span class="mn" id="MathJax-Span-31199" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31200" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="msubsup" id="MathJax-Span-31201"><span style="display: inline-block; position: relative; width: 14.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.6px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-31202" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-31203"><span class="mrow" id="MathJax-Span-31204"><span class="mo" id="MathJax-Span-31205" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-31206" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 31.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 24.9px; vertical-align: -8.4px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-995">g(z) = \frac{1}{1 + e^{-z}}</script></td></tr></tbody></table><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-996-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31207"><span style="display: inline-block; position: relative; width: 211px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(21.4px 17360px 54.8px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31208"><span class="mfrac" id="MathJax-Span-31209" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 27.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.5px -8.5px); top: -51.8px; left: 50%; margin-left: -12.5px;"><span class="mrow" id="MathJax-Span-31210"><span class="mi" id="MathJax-Span-31211" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-31212" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span class="mo" id="MathJax-Span-31213" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31214" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-31215" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.8px 17360px 46px -8.5px); top: -35.2px; left: 50%; margin-left: -5.5px;"><span class="mrow" id="MathJax-Span-31216"><span class="mi" id="MathJax-Span-31217" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-31218" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 27.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-31219" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-31220" style="font-family: STIXGeneral; padding-left: 5.4px;">−</span><span class="msubsup" id="MathJax-Span-31221"><span style="display: inline-block; position: relative; width: 60.3px; height: 0px;"><span style="position: absolute; clip: rect(34.9px 17360px 64.4px -6.3px); top: -54px; left: 0px;"><span class="mfenced" id="MathJax-Span-31222"><span class="mo" id="MathJax-Span-34215" style="vertical-align: -4.3px;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">(</span></span></span><span class="mfrac" id="MathJax-Span-31224" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 31.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45px -7.6px); top: -49.3px; left: 50%; margin-left: -3px;"><span class="mn" id="MathJax-Span-31225" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45.5px -7.6px); top: -35.1px; left: 50%; margin-left: -14.5px;"><span class="mrow" id="MathJax-Span-31226"><span class="mn" id="MathJax-Span-31227" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31228" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="msubsup" id="MathJax-Span-31229"><span style="display: inline-block; position: relative; width: 14.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.6px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-31230" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-31231"><span class="mrow" id="MathJax-Span-31232"><span class="mo" id="MathJax-Span-31233" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-31234" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 31.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-34216" style="vertical-align: -4.3px;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 54px;"></span></span><span style="position: absolute; top: -53.3px; left: 53px;"><span class="mn" id="MathJax-Span-31236" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-31237" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 13.1px; height: 0px;"><span style="position: absolute; clip: rect(30.8px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -3px;"><span class="mrow" id="MathJax-Span-31238"><span class="mi" id="MathJax-Span-31239" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="texatom" id="MathJax-Span-31240"><span class="mrow" id="MathJax-Span-31241"></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.8px 17360px 46px -8.5px); top: -35.2px; left: 50%; margin-left: -5.5px;"><span class="mrow" id="MathJax-Span-31242"><span class="mi" id="MathJax-Span-31243" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="texatom" id="MathJax-Span-31244"><span class="mrow" id="MathJax-Span-31245"><span class="mi" id="MathJax-Span-31246" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 13.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfenced" id="MathJax-Span-31247" style="padding-left: 3.3px;"><span class="mo" id="MathJax-Span-34217" style="vertical-align: 0px;"><span style="font-family: STIXGeneral;">(</span></span><span class="mrow" id="MathJax-Span-31249"><span class="mn" id="MathJax-Span-31250" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31251" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="msubsup" id="MathJax-Span-31252" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31253" style="font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8px;"><span class="texatom" id="MathJax-Span-31254"><span class="mrow" id="MathJax-Span-31255"><span class="mo" id="MathJax-Span-31256" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-31257" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span class="mo" id="MathJax-Span-34218" style="vertical-align: 0px;"><span style="font-family: STIXGeneral;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 29.4px; vertical-align: -8.8px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-996">\frac{\partial g(z)}{\partial z} = -\left( \frac{1}{1 + e^{-z}} \right)^2\frac{\partial{}}{\partial{z}} \left(1 + e^{-z} \right)</script></td></tr></tbody></table><p>The full back propagation equation for the inner nodes is then:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-997-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31259"><span style="display: inline-block; position: relative; width: 272px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.6px 17360px 50.1px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31260"><span class="msubsup" id="MathJax-Span-31261"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31262" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31263"><span class="mrow" id="MathJax-Span-31264"><span class="mo" id="MathJax-Span-31265" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31266" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31267" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31268" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-31269" style="font-family: STIXGeneral; padding-left: 5.4px;">(</span><span class="mo" id="MathJax-Span-31270" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31271"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31272" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 13px;"><span class="texatom" id="MathJax-Span-31273"><span class="mrow" id="MathJax-Span-31274"><span class="mo" id="MathJax-Span-31275" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31276" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31277" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31278"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-31279" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="mi" id="MathJax-Span-31280" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31281"><span style="display: inline-block; position: relative; width: 35.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31282" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31283"><span class="mrow" id="MathJax-Span-31284"><span class="mo" id="MathJax-Span-31285" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31286" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31287" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31288" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31289" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31290" style="font-family: STIXGeneral;">)</span><span class="mtext" id="MathJax-Span-31291" style="font-family: STIXGeneral;">&nbsp;</span><span class="mo" id="MathJax-Span-31292" style="font-family: STIXGeneral;">.</span><span class="mo" id="MathJax-Span-31293" style="font-family: STIXGeneral; padding-left: 3.3px;">∗</span><span class="mtext" id="MathJax-Span-31294" style="font-family: STIXGeneral;">&nbsp;</span><span class="msubsup" id="MathJax-Span-31295"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31296" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31297"><span class="mrow" id="MathJax-Span-31298"><span class="mo" id="MathJax-Span-31299" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31300" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31301" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mtext" id="MathJax-Span-31302" style="font-family: STIXGeneral;">&nbsp;</span><span class="mo" id="MathJax-Span-31303" style="font-family: STIXGeneral;">.</span><span class="mo" id="MathJax-Span-31304" style="font-family: STIXGeneral; padding-left: 3.3px;">∗</span><span class="mtext" id="MathJax-Span-31305" style="font-family: STIXGeneral;">&nbsp;</span><span class="mo" id="MathJax-Span-31306" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-31307" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31308" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-31309" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31310" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31311"><span class="mrow" id="MathJax-Span-31312"><span class="mo" id="MathJax-Span-31313" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31314" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31315" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31316" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.5px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-997">\delta^{(l)} = ((\Theta^{(l)})^T \delta^{(l+1)})\ .*\ a^{(l)}\ .*\ (1 - a^{(l)})</script></td></tr></tbody></table><p>A. Ng states that the derivation and proofs are complicated and involved, but you can still implement the above equations to do back propagation without knowing the details.</p><p>We can compute our partial derivative terms by multiplying our activation values and our error values for each training example t:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-998-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31317"><span style="display: inline-block; position: relative; width: 206px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(17.5px 17360px 71px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31318"><span class="mstyle" id="MathJax-Span-31319"><span class="mrow" id="MathJax-Span-31320"><span class="mfrac" id="MathJax-Span-31321" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 43.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.3px); top: -55.7px; left: 50%; margin-left: -20.5px;"><span class="mrow" id="MathJax-Span-31322"><span class="mi" id="MathJax-Span-31323" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-31324" style="font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-31325" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31326" style="font-family: STIXGeneral;">Θ</span><span class="mo" id="MathJax-Span-31327" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(24.5px 17360px 54.7px -8.3px); top: -27.7px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-31328"><span class="mi" id="MathJax-Span-31329" style="font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-31330"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31331" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31332"><span class="mrow" id="MathJax-Span-31333"><span class="mo" id="MathJax-Span-31334" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31335" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31336" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31337"><span class="mrow" id="MathJax-Span-31338"><span class="mi" id="MathJax-Span-31339" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31340" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31341" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 43.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-31342" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mfrac" id="MathJax-Span-31343" style="padding-left: 7.5px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45px -7.6px); top: -49.3px; left: 50%; margin-left: -3px;"><span class="mn" id="MathJax-Span-31344" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.9px); top: -36px; left: 50%; margin-left: -4.5px;"><span class="mi" id="MathJax-Span-31345" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="munderover" id="MathJax-Span-31346" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 35.3px; height: 0px;"><span style="position: absolute; clip: rect(27.8px 17360px 51.5px -8px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-31347" style="font-family: STIXGeneral; vertical-align: 0px;">∑</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.9px); top: -50.5px; left: 16px;"><span class="mi" id="MathJax-Span-31348" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.5px); top: -36.9px; left: 16px;"><span class="texatom" id="MathJax-Span-31349"><span class="mrow" id="MathJax-Span-31350"><span class="mi" id="MathJax-Span-31351" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31352" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-31353" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31354" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 33.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31355" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 9px;"><span class="texatom" id="MathJax-Span-31356"><span class="mrow" id="MathJax-Span-31357"><span class="mo" id="MathJax-Span-31358" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31359" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31360" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-31361" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31362" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31363" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 9px;"><span class="mi" id="MathJax-Span-31364" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31365"><span style="display: inline-block; position: relative; width: 47.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-31366"><span class="mrow" id="MathJax-Span-31367"><span class="mi" id="MathJax-Span-31368" style="font-family: STIXGeneral; font-style: italic;">δ</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 8px;"><span class="texatom" id="MathJax-Span-31369"><span class="mrow" id="MathJax-Span-31370"><span class="mo" id="MathJax-Span-31371" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31372" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31373" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-31374" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31375" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31376" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31377" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31378" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 45.1px -8.4px); top: -36.8px; left: 8px;"><span class="mi" id="MathJax-Span-31379" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 49.5px; vertical-align: -25px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-998">\dfrac{\partial J(\Theta)}{\partial \Theta_{i,j}^{(l)}} = \frac{1}{m}\sum_{t=1}^m a_j^{(t)(l)} {\delta}_i^{(t)(l+1)}</script></td></tr></tbody></table><p>This however ignores regularization, which we'll deal with later.</p><p>Note: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-999-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31380"><span style="display: inline-block; position: relative; width: 27px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.8px 17360px 44.2px -8.6px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31381"><span class="msubsup" id="MathJax-Span-31382"><span style="display: inline-block; position: relative; width: 27.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31383" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31384"><span class="mrow" id="MathJax-Span-31385"><span class="mi" id="MathJax-Span-31386" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31387" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31388" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.4px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-999">\delta^{l+1}</script> and  <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1000-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31389"><span style="display: inline-block; position: relative; width: 28px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.3px 17360px 44.2px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31390"><span class="msubsup" id="MathJax-Span-31391"><span style="display: inline-block; position: relative; width: 28.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31392" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31393"><span class="mrow" id="MathJax-Span-31394"><span class="mi" id="MathJax-Span-31395" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31396" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31397" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.9px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1000">a^{l+1}</script> are vectors with <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1001-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31398"><span style="display: inline-block; position: relative; width: 26px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(30.3px 17360px 47.1px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31399"><span class="msubsup" id="MathJax-Span-31400"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31401" style="font-family: STIXGeneral; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7px;"><span class="texatom" id="MathJax-Span-31402"><span class="mrow" id="MathJax-Span-31403"><span class="mi" id="MathJax-Span-31404" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31405" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31406" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.8px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1001">s_{l+1}</script> elements. Similarly,  <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1002-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31407"><span style="display: inline-block; position: relative; width: 27px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.3px 17360px 47.2px -9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31408"><span class="mtext" id="MathJax-Span-31409" style="font-family: STIXGeneral;">&nbsp;</span><span class="msubsup" id="MathJax-Span-31410"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31411" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31412"><span class="mrow" id="MathJax-Span-31413"><span class="mo" id="MathJax-Span-31414" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31415" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31416" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.9px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1002">\ a^{(l)}</script> is a vector with <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1003-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31417"><span style="display: inline-block; position: relative; width: 11px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(30.3px 17360px 46.7px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31418"><span class="msubsup" id="MathJax-Span-31419"><span style="display: inline-block; position: relative; width: 11.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31420" style="font-family: STIXGeneral; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7px;"><span class="mi" id="MathJax-Span-31421" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.4px; vertical-align: -3.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1003">s_l</script> elements. Multiplying them produces a matrix that is <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1004-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31422"><span style="display: inline-block; position: relative; width: 26px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(30.3px 17360px 47.1px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31423"><span class="msubsup" id="MathJax-Span-31424"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31425" style="font-family: STIXGeneral; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7px;"><span class="texatom" id="MathJax-Span-31426"><span class="mrow" id="MathJax-Span-31427"><span class="mi" id="MathJax-Span-31428" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31429" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31430" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.8px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1004">s_{l+1}</script>  by <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1005-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31431"><span style="display: inline-block; position: relative; width: 11px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(30.3px 17360px 46.7px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31432"><span class="msubsup" id="MathJax-Span-31433"><span style="display: inline-block; position: relative; width: 11.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31434" style="font-family: STIXGeneral; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7px;"><span class="mi" id="MathJax-Span-31435" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.4px; vertical-align: -3.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1005">s_l</script> which is the same dimension as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1006-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31436"><span style="display: inline-block; position: relative; width: 26px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.6px 17360px 44.2px -8.4px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31437"><span class="msubsup" id="MathJax-Span-31438"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31439" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 13px;"><span class="texatom" id="MathJax-Span-31440"><span class="mrow" id="MathJax-Span-31441"><span class="mo" id="MathJax-Span-31442" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31443" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31444" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.6px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1006">\Theta^{(l)}</script>. That is, the process produces a gradient term for every element in <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1007-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31445"><span style="display: inline-block; position: relative; width: 26px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.6px 17360px 44.2px -8.4px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31446"><span class="msubsup" id="MathJax-Span-31447"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31448" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 13px;"><span class="texatom" id="MathJax-Span-31449"><span class="mrow" id="MathJax-Span-31450"><span class="mo" id="MathJax-Span-31451" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31452" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31453" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.6px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1007">\Theta^{(l)}</script>. (Actually, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1008-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31454"><span style="display: inline-block; position: relative; width: 26px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.6px 17360px 44.2px -8.4px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31455"><span class="msubsup" id="MathJax-Span-31456"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31457" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 13px;"><span class="texatom" id="MathJax-Span-31458"><span class="mrow" id="MathJax-Span-31459"><span class="mo" id="MathJax-Span-31460" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31461" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31462" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.6px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1008">\Theta^{(l)}</script> has <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1009-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31463"><span style="display: inline-block; position: relative; width: 11px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(30.3px 17360px 46.7px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31464"><span class="msubsup" id="MathJax-Span-31465"><span style="display: inline-block; position: relative; width: 11.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31466" style="font-family: STIXGeneral; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7px;"><span class="texatom" id="MathJax-Span-31467"><span class="mrow" id="MathJax-Span-31468"><span class="mi" id="MathJax-Span-31469" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.4px; vertical-align: -3.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1009">s_{l}</script> + 1 column, so the dimensionality is not exactly the same).</p><p>We can now take all these equations and put them together into a backpropagation algorithm:</p><p><strong>Back propagation Algorithm</strong></p><p>Given training set <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1010-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31470"><span style="display: inline-block; position: relative; width: 177px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 50.6px -7.3px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31471"><span class="mo" id="MathJax-Span-31472" style="font-family: STIXGeneral;">{</span><span class="mo" id="MathJax-Span-31473" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31474"><span style="display: inline-block; position: relative; width: 24.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31475" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-31476"><span class="mrow" id="MathJax-Span-31477"><span class="mo" id="MathJax-Span-31478" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-31479" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31480" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31481" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-31482" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 23.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31483" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8px;"><span class="texatom" id="MathJax-Span-31484"><span class="mrow" id="MathJax-Span-31485"><span class="mo" id="MathJax-Span-31486" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-31487" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31488" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31489" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-31490" style="font-family: STIXGeneral; padding-left: 3.3px;">⋯</span><span class="mo" id="MathJax-Span-31491" style="font-family: STIXGeneral; padding-left: 3.3px;">(</span><span class="msubsup" id="MathJax-Span-31492"><span style="display: inline-block; position: relative; width: 27.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31493" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-31494"><span class="mrow" id="MathJax-Span-31495"><span class="mo" id="MathJax-Span-31496" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31497" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span class="mo" id="MathJax-Span-31498" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31499" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-31500" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31501" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8px;"><span class="texatom" id="MathJax-Span-31502"><span class="mrow" id="MathJax-Span-31503"><span class="mo" id="MathJax-Span-31504" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31505" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span class="mo" id="MathJax-Span-31506" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31507" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-31508" style="font-family: STIXGeneral;">}</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.2px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1010">\lbrace (x^{(1)}, y^{(1)}) \cdots (x^{(m)}, y^{(m)})\rbrace</script></p><ul><li>Set <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1011-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31509"><span style="display: inline-block; position: relative; width: 26px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(21.5px 17360px 51.7px -8.2px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31510"><span class="msubsup" id="MathJax-Span-31511"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.2px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31512" style="font-family: STIXGeneral;">Δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31513"><span class="mrow" id="MathJax-Span-31514"><span class="mo" id="MathJax-Span-31515" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31516" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31517" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31518"><span class="mrow" id="MathJax-Span-31519"><span class="mi" id="MathJax-Span-31520" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31521" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31522" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 26.3px; vertical-align: -8.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1011">\Delta^{(l)}_{i,j}</script> := 0 for all (l,i,j)</li></ul><p>For training example t =1 to m:</p><ul><li>Set <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1012-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31523"><span style="display: inline-block; position: relative; width: 73px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31524"><span class="msubsup" id="MathJax-Span-31525"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31526" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31527"><span class="mrow" id="MathJax-Span-31528"><span class="mo" id="MathJax-Span-31529" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-31530" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31531" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31532" style="font-family: STIXGeneral; padding-left: 5.4px;">:<span style="font-family: STIXGeneral; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-31533" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31534" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-31535"><span class="mrow" id="MathJax-Span-31536"><span class="mo" id="MathJax-Span-31537" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31538" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31539" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1012">a^{(1)} := x^{(t)}</script></li><li>Perform forward propagation to compute <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1013-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31540"><span style="display: inline-block; position: relative; width: 22px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.3px 17360px 44.2px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31541"><span class="msubsup" id="MathJax-Span-31542"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31543" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31544"><span class="mrow" id="MathJax-Span-31545"><span class="mo" id="MathJax-Span-31546" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31547" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31548" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.9px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1013">a^{(l)}</script> for l=2,3,…,L</li><li>Using <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1014-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31549"><span style="display: inline-block; position: relative; width: 21px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.4px 17360px 47.6px -9.4px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31550"><span class="msubsup" id="MathJax-Span-31551"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31552" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8px;"><span class="texatom" id="MathJax-Span-31553"><span class="mrow" id="MathJax-Span-31554"><span class="mo" id="MathJax-Span-31555" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31556" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31557" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.2px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1014">y^{(t)}</script>, compute <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1015-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31558"><span style="display: inline-block; position: relative; width: 113px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.8px 17360px 50.6px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31559"><span class="msubsup" id="MathJax-Span-31560"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31561" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31562"><span class="mrow" id="MathJax-Span-31563"><span class="mo" id="MathJax-Span-31564" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31565" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31566" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31567" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-31568" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31569" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31570"><span class="mrow" id="MathJax-Span-31571"><span class="mo" id="MathJax-Span-31572" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31573" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31574" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31575" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-31576" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31577" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8px;"><span class="texatom" id="MathJax-Span-31578"><span class="mrow" id="MathJax-Span-31579"><span class="mo" id="MathJax-Span-31580" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31581" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31582" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.7px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1015">\delta^{(L)} = a^{(L)} - y^{(t)}</script></li><li>Compute <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1016-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31583"><span style="display: inline-block; position: relative; width: 142px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.8px 17360px 49.4px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31584"><span class="msubsup" id="MathJax-Span-31585"><span style="display: inline-block; position: relative; width: 38.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31586" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31587"><span class="mrow" id="MathJax-Span-31588"><span class="mo" id="MathJax-Span-31589" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31590" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31591" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-31592" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31593" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31594" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-31595" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 38.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31596" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31597"><span class="mrow" id="MathJax-Span-31598"><span class="mo" id="MathJax-Span-31599" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31600" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31601" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-31602" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-31603" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31604" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-31605" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span><span class="mo" id="MathJax-Span-31606" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-31607" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 23.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31608" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31609"><span class="mrow" id="MathJax-Span-31610"><span class="mo" id="MathJax-Span-31611" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-31612" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-31613" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 19.6px; vertical-align: -3.4px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1016">\delta^{(L-1)}, \delta^{(L-2)},\dots,\delta^{(2)}</script> using <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1017-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31614"><span style="display: inline-block; position: relative; width: 272px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.6px 17360px 50.1px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31615"><span class="msubsup" id="MathJax-Span-31616"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31617" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31618"><span class="mrow" id="MathJax-Span-31619"><span class="mo" id="MathJax-Span-31620" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31621" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31622" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31623" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-31624" style="font-family: STIXGeneral; padding-left: 5.4px;">(</span><span class="mo" id="MathJax-Span-31625" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31626"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31627" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 13px;"><span class="texatom" id="MathJax-Span-31628"><span class="mrow" id="MathJax-Span-31629"><span class="mo" id="MathJax-Span-31630" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31631" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31632" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31633"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-31634" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="mi" id="MathJax-Span-31635" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31636"><span style="display: inline-block; position: relative; width: 35.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31637" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31638"><span class="mrow" id="MathJax-Span-31639"><span class="mo" id="MathJax-Span-31640" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31641" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31642" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31643" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31644" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31645" style="font-family: STIXGeneral;">)</span><span class="mtext" id="MathJax-Span-31646" style="font-family: STIXGeneral;">&nbsp;</span><span class="mo" id="MathJax-Span-31647" style="font-family: STIXGeneral;">.</span><span class="mo" id="MathJax-Span-31648" style="font-family: STIXGeneral; padding-left: 3.3px;">∗</span><span class="mtext" id="MathJax-Span-31649" style="font-family: STIXGeneral;">&nbsp;</span><span class="msubsup" id="MathJax-Span-31650"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31651" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31652"><span class="mrow" id="MathJax-Span-31653"><span class="mo" id="MathJax-Span-31654" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31655" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31656" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mtext" id="MathJax-Span-31657" style="font-family: STIXGeneral;">&nbsp;</span><span class="mo" id="MathJax-Span-31658" style="font-family: STIXGeneral;">.</span><span class="mo" id="MathJax-Span-31659" style="font-family: STIXGeneral; padding-left: 3.3px;">∗</span><span class="mtext" id="MathJax-Span-31660" style="font-family: STIXGeneral;">&nbsp;</span><span class="mo" id="MathJax-Span-31661" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-31662" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31663" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-31664" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31665" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31666"><span class="mrow" id="MathJax-Span-31667"><span class="mo" id="MathJax-Span-31668" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31669" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31670" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31671" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.5px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1017">\delta^{(l)} = ((\Theta^{(l)})^T \delta^{(l+1)})\ .*\ a^{(l)}\ .*\ (1 - a^{(l)})</script></li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1018-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31672"><span style="display: inline-block; position: relative; width: 157px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(24.5px 17360px 54.7px -8.2px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31673"><span class="msubsup" id="MathJax-Span-31674"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.2px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31675" style="font-family: STIXGeneral;">Δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31676"><span class="mrow" id="MathJax-Span-31677"><span class="mo" id="MathJax-Span-31678" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31679" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31680" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31681"><span class="mrow" id="MathJax-Span-31682"><span class="mi" id="MathJax-Span-31683" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31684" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31685" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31686" style="font-family: STIXGeneral; padding-left: 5.4px;">:<span style="font-family: STIXGeneral; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-31687" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.2px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31688" style="font-family: STIXGeneral;">Δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31689"><span class="mrow" id="MathJax-Span-31690"><span class="mo" id="MathJax-Span-31691" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31692" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31693" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31694"><span class="mrow" id="MathJax-Span-31695"><span class="mi" id="MathJax-Span-31696" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31697" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31698" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31699" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="msubsup" id="MathJax-Span-31700" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31701" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 9px;"><span class="texatom" id="MathJax-Span-31702"><span class="mrow" id="MathJax-Span-31703"><span class="mo" id="MathJax-Span-31704" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31705" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31706" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 9px;"><span class="mi" id="MathJax-Span-31707" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31708"><span style="display: inline-block; position: relative; width: 35.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31709" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 8px;"><span class="texatom" id="MathJax-Span-31710"><span class="mrow" id="MathJax-Span-31711"><span class="mo" id="MathJax-Span-31712" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31713" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31714" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31715" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31716" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 45.1px -8.4px); top: -36.8px; left: 8px;"><span class="mi" id="MathJax-Span-31717" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 26.3px; vertical-align: -8.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1018">\Delta^{(l)}_{i,j} := \Delta^{(l)}_{i,j} + a_j^{(l)} \delta_i^{(l+1)}</script> or with vectorization, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1019-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31718"><span style="display: inline-block; position: relative; width: 178px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 50.1px -8.2px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31719"><span class="msubsup" id="MathJax-Span-31720"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.2px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31721" style="font-family: STIXGeneral;">Δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 13px;"><span class="texatom" id="MathJax-Span-31722"><span class="mrow" id="MathJax-Span-31723"><span class="mo" id="MathJax-Span-31724" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31725" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31726" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31727" style="font-family: STIXGeneral; padding-left: 5.4px;">:<span style="font-family: STIXGeneral; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-31728" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.2px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31729" style="font-family: STIXGeneral;">Δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 13px;"><span class="texatom" id="MathJax-Span-31730"><span class="mrow" id="MathJax-Span-31731"><span class="mo" id="MathJax-Span-31732" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31733" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31734" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31735" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="msubsup" id="MathJax-Span-31736" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 35.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31737" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-31738"><span class="mrow" id="MathJax-Span-31739"><span class="mo" id="MathJax-Span-31740" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31741" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31742" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-31743" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31744" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31745" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31746"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31747" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-31748"><span class="mrow" id="MathJax-Span-31749"><span class="mo" id="MathJax-Span-31750" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31751" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31752" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31753"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-31754" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="mi" id="MathJax-Span-31755" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.4px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1019">\Delta^{(l)} := \Delta^{(l)} + \delta^{(l+1)}(a^{(l)})^T</script></li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1020-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31756"><span style="display: inline-block; position: relative; width: 176px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(33.5px 17360px 75.1px -9.1px); top: -60px; left: 0px;"><span class="mrow" id="MathJax-Span-31757"><span class="msubsup" id="MathJax-Span-31758"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.7px 17360px 47px -9.1px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31759" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31760"><span class="mrow" id="MathJax-Span-31761"><span class="mo" id="MathJax-Span-31762" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31763" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31764" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31765"><span class="mrow" id="MathJax-Span-31766"><span class="mi" id="MathJax-Span-31767" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31768" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31769" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31770" style="font-family: STIXGeneral; padding-left: 5.4px;">:<span style="font-family: STIXGeneral; font-style: normal; font-weight: normal;">=</span></span><span class="mstyle" id="MathJax-Span-31771" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-31772"><span class="mfrac" id="MathJax-Span-31773" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 15.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-31774" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -32.1px; left: 50%; margin-left: -6.5px;"><span class="mi" id="MathJax-Span-31775" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 15.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mfenced" id="MathJax-Span-31776" style="padding-left: 3.3px;"><span class="mo" id="MathJax-Span-34219" style="vertical-align: -6.8px;"><span style="font-family: STIXSizeTwoSym;">(</span></span><span class="mrow" id="MathJax-Span-31778"><span class="msubsup" id="MathJax-Span-31779"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.2px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31780" style="font-family: STIXGeneral;">Δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31781"><span class="mrow" id="MathJax-Span-31782"><span class="mo" id="MathJax-Span-31783" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31784" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31785" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31786"><span class="mrow" id="MathJax-Span-31787"><span class="mi" id="MathJax-Span-31788" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31789" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31790" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31791" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mi" id="MathJax-Span-31792" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">λ</span><span class="msubsup" id="MathJax-Span-31793"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31794" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31795"><span class="mrow" id="MathJax-Span-31796"><span class="mo" id="MathJax-Span-31797" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31798" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31799" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31800"><span class="mrow" id="MathJax-Span-31801"><span class="mi" id="MathJax-Span-31802" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31803" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31804" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span class="mo" id="MathJax-Span-34220" style="vertical-align: -6.8px;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 60px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 37.5px; vertical-align: -13.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1020">D^{(l)}_{i,j} := \dfrac{1}{m}\left(\Delta^{(l)}_{i,j} + \lambda\Theta^{(l)}_{i,j}\right)</script> If j≠0 NOTE: Typo in lecture slide omits outside parentheses. This version is correct.</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1021-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31806"><span style="display: inline-block; position: relative; width: 101px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(17.5px 17360px 59.1px -9.1px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31807"><span class="msubsup" id="MathJax-Span-31808"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.7px 17360px 47px -9.1px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31809" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31810"><span class="mrow" id="MathJax-Span-31811"><span class="mo" id="MathJax-Span-31812" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31813" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31814" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31815"><span class="mrow" id="MathJax-Span-31816"><span class="mi" id="MathJax-Span-31817" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31818" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31819" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31820" style="font-family: STIXGeneral; padding-left: 5.4px;">:<span style="font-family: STIXGeneral; font-style: normal; font-weight: normal;">=</span></span><span class="mstyle" id="MathJax-Span-31821" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-31822"><span class="mfrac" id="MathJax-Span-31823" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 15.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-31824" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -32.1px; left: 50%; margin-left: -6.5px;"><span class="mi" id="MathJax-Span-31825" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 15.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-31826" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.2px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31827" style="font-family: STIXGeneral;">Δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31828"><span class="mrow" id="MathJax-Span-31829"><span class="mo" id="MathJax-Span-31830" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31831" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31832" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31833"><span class="mrow" id="MathJax-Span-31834"><span class="mi" id="MathJax-Span-31835" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31836" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31837" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 37.5px; vertical-align: -13.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1021">D^{(l)}_{i,j} := \dfrac{1}{m}\Delta^{(l)}_{i,j}</script> If j=0</li></ul><p>The capital-delta matrix is used as an "accumulator" to add up our values as we go along and eventually compute our partial derivative.</p><p>The actual proof is quite involved, but, the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1022-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31838"><span style="display: inline-block; position: relative; width: 26px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(21.5px 17360px 51.7px -9.1px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31839"><span class="msubsup" id="MathJax-Span-31840"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.7px 17360px 47px -9.1px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31841" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31842"><span class="mrow" id="MathJax-Span-31843"><span class="mo" id="MathJax-Span-31844" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31845" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31846" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31847"><span class="mrow" id="MathJax-Span-31848"><span class="mi" id="MathJax-Span-31849" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31850" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31851" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 26.3px; vertical-align: -8.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1022">D^{(l)}_{i,j}</script> terms are the partial derivatives and the results we are looking for:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1023-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31852"><span style="display: inline-block; position: relative; width: 103px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(17.5px 17360px 71px -9.1px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-31853"><span class="msubsup" id="MathJax-Span-31854"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.7px 17360px 47px -9.1px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31855" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31856"><span class="mrow" id="MathJax-Span-31857"><span class="mo" id="MathJax-Span-31858" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31859" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31860" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31861"><span class="mrow" id="MathJax-Span-31862"><span class="mi" id="MathJax-Span-31863" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31864" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31865" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31866" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-31867" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-31868"><span class="mfrac" id="MathJax-Span-31869" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 43.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.3px); top: -55.7px; left: 50%; margin-left: -20.5px;"><span class="mrow" id="MathJax-Span-31870"><span class="mi" id="MathJax-Span-31871" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-31872" style="font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-31873" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31874" style="font-family: STIXGeneral;">Θ</span><span class="mo" id="MathJax-Span-31875" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(24.5px 17360px 54.7px -8.3px); top: -27.7px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-31876"><span class="mi" id="MathJax-Span-31877" style="font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-31878"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31879" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-31880"><span class="mrow" id="MathJax-Span-31881"><span class="mo" id="MathJax-Span-31882" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31883" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31884" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-31885"><span class="mrow" id="MathJax-Span-31886"><span class="mi" id="MathJax-Span-31887" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-31888" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-31889" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 43.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-31890" style="font-family: STIXGeneral; padding-left: 3.3px;">.</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 49.5px; vertical-align: -25px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1023">D_{i,j}^{(l)} = \dfrac{\partial J(\Theta)}{\partial \Theta_{i,j}^{(l)}}.</script></p><h1>Backpropagation Intuition</h1><p>The cost function is:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1024-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-31891"><span style="display: inline-block; position: relative; width: 647px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(6px 17360px 67.3px -6.2px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-31892"><span class="mtable" id="MathJax-Span-31893" style="padding-right: 2.9px; padding-left: 2.9px;"><span style="display: inline-block; position: relative; width: 643px; height: 0px;"><span style="position: absolute; clip: rect(38px 17360px 99.3px -9.1px); top: -73px; left: 0px;"><span style="display: inline-block; position: relative; width: 643px; height: 0px;"><span style="position: absolute; clip: rect(25.9px 17360px 87.2px -9.1px); top: -60.9px; left: 50%; margin-left: -321.5px;"><span class="mtd" id="MathJax-Span-31894"><span class="mrow" id="MathJax-Span-31895"><span class="mi" id="MathJax-Span-31896" style="font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-31897" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31898" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31899" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-31900" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-31901" style="font-family: STIXGeneral; padding-left: 5.4px;">−</span><span class="mfrac" id="MathJax-Span-31902" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 15.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-31903" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -32.1px; left: 50%; margin-left: -6.5px;"><span class="mi" id="MathJax-Span-31904" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 15.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="munderover" id="MathJax-Span-31905" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-31906" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 46.9px -8.5px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-31907"><span class="mrow" id="MathJax-Span-31908"><span class="mi" id="MathJax-Span-31909" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31910" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-31911" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.9px); top: -62.8px; left: 6.5px;"><span class="mi" id="MathJax-Span-31912" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="munderover" id="MathJax-Span-31913" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-31914" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 46.9px -8.8px); top: -22px; left: 1px;"><span class="texatom" id="MathJax-Span-31915"><span class="mrow" id="MathJax-Span-31916"><span class="mi" id="MathJax-Span-31917" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31918" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-31919" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.2px 17360px 45px -8.9px); top: -62.8px; left: 6.5px;"><span class="mi" id="MathJax-Span-31920" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.7px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfenced" id="MathJax-Span-31921"><span class="mo" id="MathJax-Span-34221" style="vertical-align: -6.8px;"><span style="font-family: STIXSizeTwoSym;">[</span></span><span class="mrow" id="MathJax-Span-31923"><span class="msubsup" id="MathJax-Span-31924"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31925" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.4px); top: -50.2px; left: 8px;"><span class="texatom" id="MathJax-Span-31926"><span class="mrow" id="MathJax-Span-31927"><span class="mo" id="MathJax-Span-31928" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31929" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31930" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 45.1px -8.8px); top: -36.5px; left: 8px;"><span class="mi" id="MathJax-Span-31931" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mtext" id="MathJax-Span-31932" style="font-family: STIXGeneral;">&nbsp;</span><span class="mi" id="MathJax-Span-31933" style="font-family: STIXGeneral; padding-left: 3.3px;">log</span><span class="mo" id="MathJax-Span-31934"></span><span class="mo" id="MathJax-Span-31935" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31936"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31937" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="mi" id="MathJax-Span-31938" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31939" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31940"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31941" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-31942"><span class="mrow" id="MathJax-Span-31943"><span class="mo" id="MathJax-Span-31944" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31945" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31946" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31947" style="font-family: STIXGeneral;">)</span><span class="msubsup" id="MathJax-Span-31948"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-31949" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -38.3px; left: 6px;"><span class="mi" id="MathJax-Span-31950" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31951" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mo" id="MathJax-Span-31952" style="font-family: STIXGeneral; padding-left: 4.3px;">(</span><span class="mn" id="MathJax-Span-31953" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31954" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-31955" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31956" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.4px); top: -50.2px; left: 8px;"><span class="texatom" id="MathJax-Span-31957"><span class="mrow" id="MathJax-Span-31958"><span class="mo" id="MathJax-Span-31959" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31960" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31961" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 45.1px -8.8px); top: -36.5px; left: 8px;"><span class="mi" id="MathJax-Span-31962" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31963" style="font-family: STIXGeneral;">)</span><span class="mtext" id="MathJax-Span-31964" style="font-family: STIXGeneral;">&nbsp;</span><span class="mi" id="MathJax-Span-31965" style="font-family: STIXGeneral; padding-left: 3.3px;">log</span><span class="mo" id="MathJax-Span-31966"></span><span class="mo" id="MathJax-Span-31967" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-31968" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-31969" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-31970" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31971" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="mi" id="MathJax-Span-31972" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31973" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-31974"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-31975" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-31976"><span class="mrow" id="MathJax-Span-31977"><span class="mo" id="MathJax-Span-31978" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-31979" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-31980" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-31981"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-31982" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -38.3px; left: 6px;"><span class="mi" id="MathJax-Span-31983" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-31984" style="font-family: STIXGeneral;">)</span></span><span class="mo" id="MathJax-Span-34222" style="vertical-align: -6.8px;"><span style="font-family: STIXSizeTwoSym;">]</span></span></span><span class="mo" id="MathJax-Span-31986" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mfrac" id="MathJax-Span-31987" style="padding-left: 6.4px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 23.1px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.3px -9.2px); top: -55.7px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-31988" style="font-family: STIXGeneral; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.5px); top: -32.1px; left: 50%; margin-left: -10.5px;"><span class="mrow" id="MathJax-Span-31989"><span class="mn" id="MathJax-Span-31990" style="font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-31991" style="font-family: STIXGeneral; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 23.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="munderover" id="MathJax-Span-31992" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-31993" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 46.9px -8.5px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-31994"><span class="mrow" id="MathJax-Span-31995"><span class="mi" id="MathJax-Span-31996" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-31997" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-31998" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29px 17360px 45px -9.1px); top: -62.8px; left: 0.5px;"><span class="texatom" id="MathJax-Span-31999"><span class="mrow" id="MathJax-Span-32000"><span class="mi" id="MathJax-Span-32001" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32002" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32003" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="munderover" id="MathJax-Span-32004" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-32005" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 46.9px -8.4px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-32006"><span class="mrow" id="MathJax-Span-32007"><span class="mi" id="MathJax-Span-32008" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-32009" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-32010" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(58.8px 17360px 73.9px -8.8px); top: -90px; left: 7px;"><span class="texatom" id="MathJax-Span-32011"><span class="mrow" id="MathJax-Span-32012"><span class="msubsup" id="MathJax-Span-32013"><span style="display: inline-block; position: relative; width: 7.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.2px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32014" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -39.2px; left: 5px;"><span class="mi" id="MathJax-Span-32015" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="munderover" id="MathJax-Span-32016" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-32017" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -10.5px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-32018"><span class="mrow" id="MathJax-Span-32019"><span class="mi" id="MathJax-Span-32020" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32021" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-32022" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29px 17360px 46.9px -8.8px); top: -63px; left: 0px;"><span class="texatom" id="MathJax-Span-32023"><span class="mrow" id="MathJax-Span-32024"><span class="msubsup" id="MathJax-Span-32025"><span style="display: inline-block; position: relative; width: 7.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.2px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32026" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -39.2px; left: 5px;"><span class="mi" id="MathJax-Span-32027" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span><span class="mo" id="MathJax-Span-32028" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-32029" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32030" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-32031"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32032" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 9.9px;"><span class="texatom" id="MathJax-Span-32033"><span class="mrow" id="MathJax-Span-32034"><span class="mo" id="MathJax-Span-32035" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32036" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32037" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.8px; left: 8.8px;"><span class="texatom" id="MathJax-Span-32038"><span class="mrow" id="MathJax-Span-32039"><span class="mi" id="MathJax-Span-32040" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32041" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-32042" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-32043"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-32044" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-32045" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 60px;"></span></span></span><span style="display: inline-block; width: 0px; height: 73px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 57.3px; vertical-align: -24.3px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1024">\begin{gather*}J(\theta) = - \frac{1}{m} \sum_{t=1}^m\sum_{k=1}^K  \left[ y^{(t)}_k \ \log (h_\theta (x^{(t)}))_k + (1 - y^{(t)}_k)\ \log (1 - h_\theta(x^{(t)})_k)\right] + \frac{\lambda}{2m}\sum_{l=1}^{L-1} \sum_{i=1}^{s_l} \sum_{j=1}^{s_l+1} ( \theta_{j,i}^{(l)})^2\end{gather*}</script></td></tr></tbody></table><p>If we consider simple non-multiclass classification (k = 1) and disregard regularization, the cost is computed with:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1025-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32046"><span style="display: inline-block; position: relative; width: 380px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 50.8px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32047"><span class="mi" id="MathJax-Span-32048" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mi" id="MathJax-Span-32049" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-32050" style="font-family: STIXGeneral; font-style: italic;">s</span><span class="mi" id="MathJax-Span-32051" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-32052" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32053" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-32054" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32055" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-32056" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32057" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8px;"><span class="texatom" id="MathJax-Span-32058"><span class="mrow" id="MathJax-Span-32059"><span class="mo" id="MathJax-Span-32060" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32061" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32062" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mtext" id="MathJax-Span-32063" style="font-family: STIXGeneral;">&nbsp;</span><span class="mi" id="MathJax-Span-32064" style="font-family: STIXGeneral; padding-left: 3.3px;">log</span><span class="mo" id="MathJax-Span-32065"></span><span class="mo" id="MathJax-Span-32066" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-32067"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32068" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="mi" id="MathJax-Span-32069" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32070" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-32071"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32072" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-32073"><span class="mrow" id="MathJax-Span-32074"><span class="mo" id="MathJax-Span-32075" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32076" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32077" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32078" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32079" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32080" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mo" id="MathJax-Span-32081" style="font-family: STIXGeneral; padding-left: 4.3px;">(</span><span class="mn" id="MathJax-Span-32082" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32083" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-32084" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32085" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8px;"><span class="texatom" id="MathJax-Span-32086"><span class="mrow" id="MathJax-Span-32087"><span class="mo" id="MathJax-Span-32088" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32089" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32090" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32091" style="font-family: STIXGeneral;">)</span><span class="mtext" id="MathJax-Span-32092" style="font-family: STIXGeneral;">&nbsp;</span><span class="mi" id="MathJax-Span-32093" style="font-family: STIXGeneral; padding-left: 3.3px;">log</span><span class="mo" id="MathJax-Span-32094"></span><span class="mo" id="MathJax-Span-32095" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-32096" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32097" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-32098" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32099" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="mi" id="MathJax-Span-32100" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32101" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-32102"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32103" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-32104"><span class="mrow" id="MathJax-Span-32105"><span class="mo" id="MathJax-Span-32106" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32107" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32108" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32109" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32110" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.4px; vertical-align: -4.8px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1025">cost(t) =y^{(t)} \ \log (h_\theta (x^{(t)})) + (1 - y^{(t)})\ \log (1 - h_\theta(x^{(t)}))</script></td></tr></tbody></table><p>More intuitively you can think of that equation roughly as:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1026-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32111"><span style="display: inline-block; position: relative; width: 177px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 50.6px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32112"><span class="mi" id="MathJax-Span-32113" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mi" id="MathJax-Span-32114" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-32115" style="font-family: STIXGeneral; font-style: italic;">s</span><span class="mi" id="MathJax-Span-32116" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-32117" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32118" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-32119" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32120" style="font-family: STIXGeneral; padding-left: 5.4px;">≈</span><span class="mo" id="MathJax-Span-32121" style="font-family: STIXGeneral; padding-left: 5.4px;">(</span><span class="msubsup" id="MathJax-Span-32122"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32123" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="mi" id="MathJax-Span-32124" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32125" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-32126"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32127" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-32128"><span class="mrow" id="MathJax-Span-32129"><span class="mo" id="MathJax-Span-32130" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32131" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32132" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32133" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32134" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-32135" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32136" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8px;"><span class="texatom" id="MathJax-Span-32137"><span class="mrow" id="MathJax-Span-32138"><span class="mo" id="MathJax-Span-32139" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32140" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32141" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-32142"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-32143" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="mn" id="MathJax-Span-32144" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.9px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1026">cost(t) \approx (h_\theta(x^{(t)})-y^{(t)})^2</script></td></tr></tbody></table><p>Intuitively, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1027-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32145"><span style="display: inline-block; position: relative; width: 21px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(21.5px 17360px 51.7px -8.6px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-32146"><span class="msubsup" id="MathJax-Span-32147"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32148" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 8px;"><span class="texatom" id="MathJax-Span-32149"><span class="mrow" id="MathJax-Span-32150"><span class="mo" id="MathJax-Span-32151" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32152" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32153" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 8px;"><span class="mi" id="MathJax-Span-32154" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 26.2px; vertical-align: -8.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1027">\delta_j^{(l)}</script> is the "error" for <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1028-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32155"><span style="display: inline-block; position: relative; width: 22px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(21.5px 17360px 51.7px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-32156"><span class="msubsup" id="MathJax-Span-32157"><span style="display: inline-block; position: relative; width: 22.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32158" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 9px;"><span class="texatom" id="MathJax-Span-32159"><span class="mrow" id="MathJax-Span-32160"><span class="mo" id="MathJax-Span-32161" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32162" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32163" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 9px;"><span class="mi" id="MathJax-Span-32164" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 26.2px; vertical-align: -8.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1028">a^{(l)}_j</script> (unit j in layer l)</p><p>More formally, the delta values are actually the derivative of the cost function:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1029-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32165"><span style="display: inline-block; position: relative; width: 125px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(17.7px 17360px 70.9px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32166"><span class="msubsup" id="MathJax-Span-32167"><span style="display: inline-block; position: relative; width: 21.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32168" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 8px;"><span class="texatom" id="MathJax-Span-32169"><span class="mrow" id="MathJax-Span-32170"><span class="mo" id="MathJax-Span-32171" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32172" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32173" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 8px;"><span class="mi" id="MathJax-Span-32174" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32175" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-32176" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-32177"><span class="mfrac" id="MathJax-Span-32178" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 30.1px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.3px); top: -55.7px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-32179" style="font-family: STIXGeneral;">∂</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(24.5px 17360px 54.7px -8.3px); top: -27.7px; left: 50%; margin-left: -14px;"><span class="mrow" id="MathJax-Span-32180"><span class="mi" id="MathJax-Span-32181" style="font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32182"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 48.4px -9px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32183" style="font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 7px;"><span class="texatom" id="MathJax-Span-32184"><span class="mrow" id="MathJax-Span-32185"><span class="mo" id="MathJax-Span-32186" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32187" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32188" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 7px;"><span class="mi" id="MathJax-Span-32189" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 30.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-32190" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">c</span><span class="mi" id="MathJax-Span-32191" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-32192" style="font-family: STIXGeneral; font-style: italic;">s</span><span class="mi" id="MathJax-Span-32193" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-32194" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32195" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-32196" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 49.3px; vertical-align: -24.9px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1029">\delta_j^{(l)} = \dfrac{\partial}{\partial z_j^{(l)}} cost(t)</script></td></tr></tbody></table><p>Recall that our derivative is the slope of a line tangent to the cost function, so the steeper the slope the more incorrect we are.</p><p>Note: In lecture, sometimes i is used to index a training example. Sometimes it is used to index a unit in a layer. In the Back Propagation Algorithm described here, t is used to index a training example rather than overloading the use of i.</p><h1>Implementation Note: Unrolling Parameters</h1><p>With neural networks, we are working with sets of matrices:</p><table><tbody><tr><td><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1030-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32197"><span style="display: inline-block; position: relative; width: 128px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(12.3px 17360px 61px -6.2px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-32198"><span class="mtable" id="MathJax-Span-32199" style="padding-right: 2.9px; padding-left: 2.9px;"><span style="display: inline-block; position: relative; width: 124px; height: 0px;"><span style="position: absolute; clip: rect(40.3px 17360px 88px -9.1px); top: -69px; left: 0px;"><span style="display: inline-block; position: relative; width: 124px; height: 0px;"><span style="position: absolute; clip: rect(25.5px 17360px 49.4px -8.4px); top: -54.2px; right: 0px;"><span class="mtd" id="MathJax-Span-32200"><span class="mrow" id="MathJax-Span-32201"><span class="msubsup" id="MathJax-Span-32202"><span style="display: inline-block; position: relative; width: 28.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32203" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 13px;"><span class="texatom" id="MathJax-Span-32204"><span class="mrow" id="MathJax-Span-32205"><span class="mo" id="MathJax-Span-32206" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-32207" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32208" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32209" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-32210" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 28.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32211" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 13px;"><span class="texatom" id="MathJax-Span-32212"><span class="mrow" id="MathJax-Span-32213"><span class="mo" id="MathJax-Span-32214" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-32215" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-32216" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32217" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-32218" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 28.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32219" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 13px;"><span class="texatom" id="MathJax-Span-32220"><span class="mrow" id="MathJax-Span-32221"><span class="mo" id="MathJax-Span-32222" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-32223" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span class="mo" id="MathJax-Span-32224" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32225" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-32226" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(25.5px 17360px 49.4px -9.1px); top: -30.5px; right: 0px;"><span class="mtd" id="MathJax-Span-32227"><span class="mrow" id="MathJax-Span-32228"><span class="msubsup" id="MathJax-Span-32229"><span style="display: inline-block; position: relative; width: 28.3px; height: 0px;"><span style="position: absolute; clip: rect(29.7px 17360px 47px -9.1px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32230" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 13px;"><span class="texatom" id="MathJax-Span-32231"><span class="mrow" id="MathJax-Span-32232"><span class="mo" id="MathJax-Span-32233" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-32234" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32235" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32236" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-32237" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 28.3px; height: 0px;"><span style="position: absolute; clip: rect(29.7px 17360px 47px -9.1px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32238" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 13px;"><span class="texatom" id="MathJax-Span-32239"><span class="mrow" id="MathJax-Span-32240"><span class="mo" id="MathJax-Span-32241" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-32242" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-32243" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32244" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-32245" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 28.3px; height: 0px;"><span style="position: absolute; clip: rect(29.7px 17360px 47px -9.1px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32246" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 13px;"><span class="texatom" id="MathJax-Span-32247"><span class="mrow" id="MathJax-Span-32248"><span class="mo" id="MathJax-Span-32249" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-32250" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span class="mo" id="MathJax-Span-32251" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32252" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-32253" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 44.7px; vertical-align: -18px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1030">\begin{align*}
\Theta^{(1)}, \Theta^{(2)}, \Theta^{(3)}, \dots \newline
D^{(1)}, D^{(2)}, D^{(3)}, \dots
\end{align*}</script></td></tr></tbody></table><p>In order to use optimizing functions such as "fminunc()", we will want to "unroll" all the elements and put them into one long vector:</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 266.012px; top: 16px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div></div><div class="ace_gutter-active-line" style="top: 16px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_bracket ace_start ace_br15" style="height:16px;width:6.0003125px;top:16px;left:88.004375px;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">thetaVector = [ Theta1(:); Theta2(:); Theta3(:); ]</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">deltaVector = [ D1(:); D2(:); D3(:) ]</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 226.012px; top: 16px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 32px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>If the dimensions of Theta1 is 10x11, Theta2 is 10x11 and Theta3 is 1x11, then we can get back our original matrices from the "unrolled" versions as follows:</p><pre contenteditable="false" style="height: 66px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 48px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 96px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div></div><div class="ace_gutter-active-line" style="top: 48px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 96px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Theta1 = reshape(thetaVector(1:110),10,11)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Theta2 = reshape(thetaVector(111:220),10,11)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Theta3 = reshape(thetaVector(221:231),1,11)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 48px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 64px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>NOTE: The lecture slides show an example neural network with 3 layers. However, <em>3</em> theta matrices are defined: Theta1, Theta2, Theta3. There should be only 2 theta matrices: Theta1 (10 x 11), Theta2 (1 x 11).</p><h1>Gradient Checking</h1><p>Gradient checking will assure that our backpropagation works as intended.</p><p>We can approximate the derivative of our cost function with:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1031-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32254"><span style="display: inline-block; position: relative; width: 231px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(17.5px 17360px 59.2px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32255"><span class="mstyle" id="MathJax-Span-32256"><span class="mrow" id="MathJax-Span-32257"><span class="mfrac" id="MathJax-Span-32258" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 23.1px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.3px); top: -55.7px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-32259" style="font-family: STIXGeneral;">∂</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.3px); top: -32.1px; left: 50%; margin-left: -10.5px;"><span class="mrow" id="MathJax-Span-32260"><span class="mi" id="MathJax-Span-32261" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-32262" style="font-family: STIXGeneral;">Θ</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 23.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-32263" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-32264" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32265" style="font-family: STIXGeneral;">Θ</span><span class="mo" id="MathJax-Span-32266" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32267" style="font-family: STIXGeneral; padding-left: 5.4px;">≈</span><span class="mstyle" id="MathJax-Span-32268" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-32269"><span class="mfrac" id="MathJax-Span-32270" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 142.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -9.1px); top: -55.7px; left: 50%; margin-left: -70px;"><span class="mrow" id="MathJax-Span-32271"><span class="mi" id="MathJax-Span-32272" style="font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-32273" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32274" style="font-family: STIXGeneral;">Θ</span><span class="mo" id="MathJax-Span-32275" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mi" id="MathJax-Span-32276" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">ϵ</span><span class="mo" id="MathJax-Span-32277" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32278" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-32279" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-32280" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32281" style="font-family: STIXGeneral;">Θ</span><span class="mo" id="MathJax-Span-32282" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-32283" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">ϵ</span><span class="mo" id="MathJax-Span-32284" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.5px); top: -32.1px; left: 50%; margin-left: -8px;"><span class="mrow" id="MathJax-Span-32285"><span class="mn" id="MathJax-Span-32286" style="font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-32287" style="font-family: STIXGeneral; font-style: italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 142.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 37.6px; vertical-align: -13.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1031">\dfrac{\partial}{\partial\Theta}J(\Theta) \approx \dfrac{J(\Theta + \epsilon) - J(\Theta - \epsilon)}{2\epsilon}</script></p><p>With multiple theta matrices, we can approximate the derivative <strong>with respect to</strong> <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1032-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32288"><span style="display: inline-block; position: relative; width: 17px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.3px 17360px 49.1px -8.4px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-32289"><span class="msubsup" id="MathJax-Span-32290"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-32291"><span class="mrow" id="MathJax-Span-32292"><span class="mo" id="MathJax-Span-32293" style="font-family: STIXGeneral;">Θ</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 13px;"><span class="mi" id="MathJax-Span-32294" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 18.9px; vertical-align: -6.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1032">Θ_j</script> as follows:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1033-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32295"><span style="display: inline-block; position: relative; width: 466px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(15.7px 17360px 64.1px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32296"><span class="mstyle" id="MathJax-Span-32297"><span class="mrow" id="MathJax-Span-32298"><span class="mfrac" id="MathJax-Span-32299" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 27.1px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.3px); top: -55.7px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-32300" style="font-family: STIXGeneral;">∂</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 52.1px -8.3px); top: -32.1px; left: 50%; margin-left: -12.5px;"><span class="mrow" id="MathJax-Span-32301"><span class="mi" id="MathJax-Span-32302" style="font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32303"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32304" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 13px;"><span class="mi" id="MathJax-Span-32305" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 27.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-32306" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-32307" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32308" style="font-family: STIXGeneral;">Θ</span><span class="mo" id="MathJax-Span-32309" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32310" style="font-family: STIXGeneral; padding-left: 5.4px;">≈</span><span class="mstyle" id="MathJax-Span-32311" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-32312"><span class="mfrac" id="MathJax-Span-32313" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 373.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 52.1px -9.1px); top: -57.5px; left: 50%; margin-left: -185.5px;"><span class="mrow" id="MathJax-Span-32314"><span class="mi" id="MathJax-Span-32315" style="font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-32316" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-32317"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32318" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 13px;"><span class="mn" id="MathJax-Span-32319" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32320" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-32321" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span><span class="mo" id="MathJax-Span-32322" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-32323" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32324" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 13px;"><span class="mi" id="MathJax-Span-32325" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32326" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mi" id="MathJax-Span-32327" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">ϵ</span><span class="mo" id="MathJax-Span-32328" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-32329" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span><span class="mo" id="MathJax-Span-32330" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-32331" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32332" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 13px;"><span class="mi" id="MathJax-Span-32333" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32334" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32335" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-32336" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-32337" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-32338"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32339" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 13px;"><span class="mn" id="MathJax-Span-32340" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32341" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-32342" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span><span class="mo" id="MathJax-Span-32343" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-32344" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32345" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 13px;"><span class="mi" id="MathJax-Span-32346" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32347" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-32348" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">ϵ</span><span class="mo" id="MathJax-Span-32349" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-32350" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span><span class="mo" id="MathJax-Span-32351" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-32352" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32353" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 13px;"><span class="mi" id="MathJax-Span-32354" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32355" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.5px); top: -32.1px; left: 50%; margin-left: -8px;"><span class="mrow" id="MathJax-Span-32356"><span class="mn" id="MathJax-Span-32357" style="font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-32358" style="font-family: STIXGeneral; font-style: italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 373.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 44.3px; vertical-align: -18.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1033">\dfrac{\partial}{\partial\Theta_j}J(\Theta) \approx \dfrac{J(\Theta_1, \dots, \Theta_j + \epsilon, \dots, \Theta_n) - J(\Theta_1, \dots, \Theta_j - \epsilon, \dots, \Theta_n)}{2\epsilon}</script></p><p>A good small value for <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1034-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32359"><span style="display: inline-block; position: relative; width: 8px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32360"><span class="texatom" id="MathJax-Span-32361"><span class="mrow" id="MathJax-Span-32362"><span class="mi" id="MathJax-Span-32363" style="font-family: STIXGeneral; font-style: italic;">ϵ</span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 9.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1034">{\epsilon}</script> (epsilon), guarantees the math above to become true. If the value be much smaller, may we will end up with numerical problems. The professor Andrew usually uses the value <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1035-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32364"><span style="display: inline-block; position: relative; width: 63px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32365"><span class="texatom" id="MathJax-Span-32366"><span class="mrow" id="MathJax-Span-32367"><span class="mi" id="MathJax-Span-32368" style="font-family: STIXGeneral; font-style: italic;">ϵ</span><span class="mo" id="MathJax-Span-32369" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-32370" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 33.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -7.1px); top: -44px; left: 0px;"><span class="mn" id="MathJax-Span-32371" style="font-family: STIXGeneral;">10</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 17px;"><span class="texatom" id="MathJax-Span-32372"><span class="mrow" id="MathJax-Span-32373"><span class="mo" id="MathJax-Span-32374" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32375" style="font-size: 70.7%; font-family: STIXGeneral;">4</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.5px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1035">{\epsilon = 10^{-4}}</script>.</p><p>We are only adding or subtracting epsilon to the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1036-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32376"><span style="display: inline-block; position: relative; width: 46px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.1px 17360px 52.1px -8px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32377"><span class="mi" id="MathJax-Span-32378" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 1.3px;"></span></span><span class="mi" id="MathJax-Span-32379" style="font-family: STIXGeneral; font-style: italic;">h</span><span class="mi" id="MathJax-Span-32380" style="font-family: STIXGeneral; font-style: italic;">e</span><span class="mi" id="MathJax-Span-32381" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="msubsup" id="MathJax-Span-32382"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32383" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="mi" id="MathJax-Span-32384" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 19px; vertical-align: -6.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1036">Theta_j</script> matrix. In octave we can do it as follows:</p><pre contenteditable="false" style="height: 146px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 50px; top: 128px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 176px; width: 46px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div></div><div class="ace_gutter-active-line" style="top: 128px; height: 16px;"></div></div><div class="ace_scroller" style="left: 46px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 912px; height: 176px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">epsilon = 1e-4;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">for i = 1:n,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  thetaPlus = theta;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  thetaPlus(i) += epsilon;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  thetaMinus = theta;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  thetaMinus(i) -= epsilon;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">  gradApprox(i) = (J(thetaPlus) - J(thetaMinus))/(2*epsilon)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">end;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 128px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 144px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 46px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 912px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>We then want to check that gradApprox ≈ deltaVector.</p><p>Once you've verified <strong>once</strong> that your backpropagation algorithm is correct, then you don't need to compute gradApprox again. The code to compute gradApprox is very slow.</p><h1>Random Initialization</h1><p>Initializing all theta weights to zero does not work with neural networks. When we backpropagate, all nodes will update to the same value repeatedly.</p><p>Instead we can randomly initialize our weights:</p><p>Initialize each <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1037-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32385"><span style="display: inline-block; position: relative; width: 26px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(21.5px 17360px 51.7px -8.4px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-32386"><span class="msubsup" id="MathJax-Span-32387"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32388" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 47.2px -8.4px); top: -50.2px; left: 13px;"><span class="texatom" id="MathJax-Span-32389"><span class="mrow" id="MathJax-Span-32390"><span class="mo" id="MathJax-Span-32391" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32392" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32393" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -8.4px); top: -36.8px; left: 13px;"><span class="texatom" id="MathJax-Span-32394"><span class="mrow" id="MathJax-Span-32395"><span class="mi" id="MathJax-Span-32396" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mi" id="MathJax-Span-32397" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 26.3px; vertical-align: -8.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1037">\Theta^{(l)}_{ij}</script> to a random value between<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1038-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32398"><span style="display: inline-block; position: relative; width: 46px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.5px 17360px 49.7px -7.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32399"><span class="mo" id="MathJax-Span-32400" style="font-family: STIXGeneral;">[</span><span class="mo" id="MathJax-Span-32401" style="font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-32402" style="font-family: STIXGeneral; font-style: italic;">ϵ</span><span class="mo" id="MathJax-Span-32403" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-32404" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">ϵ</span><span class="mo" id="MathJax-Span-32405" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.2px; vertical-align: -3.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1038"> [-\epsilon,\epsilon]</script>:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1039-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32406"><span style="display: inline-block; position: relative; width: 173px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(14.9px 17360px 68.3px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32407"><span class="mi" id="MathJax-Span-32408" style="font-family: STIXGeneral; font-style: italic;">ϵ</span><span class="mo" id="MathJax-Span-32409" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-32410" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-32411"><span class="mfrac" id="MathJax-Span-32412" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 139.5px; height: 0px;"><span style="position: absolute; clip: rect(51.6px 17360px 74.4px -7.8px); top: -80.7px; left: 50%; margin-left: -11.2px;"><span class="msqrt" id="MathJax-Span-32413"><span style="display: inline-block; position: relative; width: 22.4px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.4px); top: -44px; left: 13px;"><span class="mrow" id="MathJax-Span-32414"><span class="mn" id="MathJax-Span-32415" style="font-family: STIXGeneral;">6</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(51.8px 17360px 58.6px -9px); top: -69.1px; left: 13px;"><span style="display: inline-block; position: relative; width: 9.4px; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -69px; left: 0px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -69px; left: 0.8px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; clip: rect(49.6px 17360px 72.2px -7.8px); top: -66.8px; left: 0px;"><span style="font-family: STIXVariants;">√</span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; clip: rect(51px 17360px 78.5px -7.1px); top: -54.3px; left: 50%; margin-left: -68.7px;"><span class="msqrt" id="MathJax-Span-32416"><span style="display: inline-block; position: relative; width: 137.4px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 50.8px -8.8px); top: -44px; left: 16px;"><span class="mrow" id="MathJax-Span-32417"><span class="texatom" id="MathJax-Span-32418"><span class="mrow" id="MathJax-Span-32419"><span class="mi" id="MathJax-Span-32420" style="font-family: STIXGeneral;">L</span><span class="mi" id="MathJax-Span-32421" style="font-family: STIXGeneral;">o</span><span class="mi" id="MathJax-Span-32422" style="font-family: STIXGeneral;">u</span><span class="mi" id="MathJax-Span-32423" style="font-family: STIXGeneral;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mi" id="MathJax-Span-32424" style="font-family: STIXGeneral;">p</span><span class="mi" id="MathJax-Span-32425" style="font-family: STIXGeneral;">u</span><span class="mi" id="MathJax-Span-32426" style="font-family: STIXGeneral;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span class="mo" id="MathJax-Span-32427" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="texatom" id="MathJax-Span-32428" style="padding-left: 4.3px;"><span class="mrow" id="MathJax-Span-32429"><span class="mi" id="MathJax-Span-32430" style="font-family: STIXGeneral;">L</span><span class="mi" id="MathJax-Span-32431" style="font-family: STIXGeneral;">i</span><span class="mi" id="MathJax-Span-32432" style="font-family: STIXGeneral;">n</span><span class="mi" id="MathJax-Span-32433" style="font-family: STIXGeneral;">p</span><span class="mi" id="MathJax-Span-32434" style="font-family: STIXGeneral;">u</span><span class="mi" id="MathJax-Span-32435" style="font-family: STIXGeneral;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(51.8px 17360px 58.6px -9px); top: -69.8px; left: 16px;"><span style="display: inline-block; position: relative; width: 121.4px; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -69px; left: 0px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -69px; left: 112.8px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 7.1px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 14.7px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 22.2px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 29.7px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 37.3px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 44.8px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 52.4px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 59.9px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 67.5px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 75px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 82.6px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 90.1px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 97.7px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 105.2px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; clip: rect(49.1px 17360px 76.5px -7.1px); top: -67px; left: 0px;"><span style="font-family: STIXGeneral;">√</span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 139.5px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 49.4px; vertical-align: -22.3px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1039">\epsilon = \dfrac{\sqrt{6}}{\sqrt{\mathrm{Loutput} + \mathrm{Linput}}}</script></p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1040-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32436"><span style="display: inline-block; position: relative; width: 277px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.6px 17360px 50.8px -8.4px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32437"><span class="msubsup" id="MathJax-Span-32438"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -8.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32439" style="font-family: STIXGeneral;">Θ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 13px;"><span class="texatom" id="MathJax-Span-32440"><span class="mrow" id="MathJax-Span-32441"><span class="mo" id="MathJax-Span-32442" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32443" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32444" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32445" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mn" id="MathJax-Span-32446" style="font-family: STIXGeneral; padding-left: 5.4px;">2</span><span class="mi" id="MathJax-Span-32447" style="font-family: STIXGeneral; font-style: italic;">ϵ</span><span class="mspace" id="MathJax-Span-32448" style="height: 0px; vertical-align: 0px; width: 5.4px; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-32449"><span class="mrow" id="MathJax-Span-32450"><span class="mi" id="MathJax-Span-32451" style="font-family: STIXGeneral;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mi" id="MathJax-Span-32452" style="font-family: STIXGeneral;">a</span><span class="mi" id="MathJax-Span-32453" style="font-family: STIXGeneral;">n</span><span class="mi" id="MathJax-Span-32454" style="font-family: STIXGeneral;">d</span></span></span><span class="mo" id="MathJax-Span-32455" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-32456"><span class="mrow" id="MathJax-Span-32457"><span class="mi" id="MathJax-Span-32458" style="font-family: STIXGeneral;">L</span><span class="mi" id="MathJax-Span-32459" style="font-family: STIXGeneral;">o</span><span class="mi" id="MathJax-Span-32460" style="font-family: STIXGeneral;">u</span><span class="mi" id="MathJax-Span-32461" style="font-family: STIXGeneral;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mi" id="MathJax-Span-32462" style="font-family: STIXGeneral;">p</span><span class="mi" id="MathJax-Span-32463" style="font-family: STIXGeneral;">u</span><span class="mi" id="MathJax-Span-32464" style="font-family: STIXGeneral;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span class="mo" id="MathJax-Span-32465" style="font-family: STIXGeneral;">,</span><span class="texatom" id="MathJax-Span-32466" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-32467"><span class="mi" id="MathJax-Span-32468" style="font-family: STIXGeneral;">L</span><span class="mi" id="MathJax-Span-32469" style="font-family: STIXGeneral;">i</span><span class="mi" id="MathJax-Span-32470" style="font-family: STIXGeneral;">n</span><span class="mi" id="MathJax-Span-32471" style="font-family: STIXGeneral;">p</span><span class="mi" id="MathJax-Span-32472" style="font-family: STIXGeneral;">u</span><span class="mi" id="MathJax-Span-32473" style="font-family: STIXGeneral;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span></span></span><span class="mo" id="MathJax-Span-32474" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mn" id="MathJax-Span-32475" style="font-family: STIXGeneral; padding-left: 4.3px;">1</span><span class="mo" id="MathJax-Span-32476" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32477" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-32478" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 21.1px; vertical-align: -4.8px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1040">\Theta^{(l)} =  2 \epsilon \; \mathrm{rand}(\mathrm{Loutput}, \mathrm{Linput} + 1)    - \epsilon</script></p><pre contenteditable="false" style="height: 98px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 80px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 128px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div></div><div class="ace_gutter-active-line" style="top: 80px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 128px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">If the dimensions of Theta1 is 10x11, Theta2 is 10x11 and Theta3 is 1x11.</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Theta1 = rand(10,11) * (2 * INIT_EPSILON) - INIT_EPSILON;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Theta2 = rand(10,11) * (2 * INIT_EPSILON) - INIT_EPSILON;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Theta3 = rand(1,11) * (2 * INIT_EPSILON) - INIT_EPSILON;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 80px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 96px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>rand(x,y) will initialize a matrix of random real numbers between 0 and 1. (Note: this epsilon is unrelated to the epsilon from Gradient Checking)</p><p>Why use this method? This paper may be useful: <a href="https://web.stanford.edu/class/ee373b/nninitialization.pdf" target="_blank" rel="noopener nofollow">https://web.stanford.edu/class/ee373b/nninitialization.pdf</a> </p><h1>Putting it Together</h1><p>First, pick a network architecture; choose the layout of your neural network, including how many hidden units in each layer and how many layers total.</p><ul><li>Number of input units = dimension of features <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1041-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32479"><span style="display: inline-block; position: relative; width: 22px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.4px 17360px 44.2px -9.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-32480"><span class="msubsup" id="MathJax-Span-32481"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32482" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-32483"><span class="mrow" id="MathJax-Span-32484"><span class="mo" id="MathJax-Span-32485" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32486" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-32487" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1041">x^{(i)}</script></li><li>Number of output units = number of classes</li><li>Number of hidden units per layer = usually more the better (must balance with cost of computation as it increases with more hidden units)</li><li>Defaults: 1 hidden layer. If more than 1 hidden layer, then the same number of units in every hidden layer.</li></ul><p><strong>Training a Neural Network</strong></p><ol><li>Randomly initialize the weights</li><li>Implement forward propagation to get <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1042-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32488"><span style="display: inline-block; position: relative; width: 50px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 50.1px -8.7px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32489"><span class="msubsup" id="MathJax-Span-32490"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32491" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="mi" id="MathJax-Span-32492" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32493" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-32494"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32495" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-32496"><span class="mrow" id="MathJax-Span-32497"><span class="mo" id="MathJax-Span-32498" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32499" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-32500" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32501" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 19.7px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1042">h_\theta(x^{(i)})</script></li><li>Implement the cost function</li><li>Implement backpropagation to compute partial derivatives</li><li>Use gradient checking to confirm that your backpropagation works. Then disable gradient checking.</li><li>Use gradient descent or a built-in optimization function to minimize the cost function with the weights in theta.</li></ol><p>When we perform forward and back propagation, we loop on every training example:</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 410.019px; top: 32px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div></div><div class="ace_gutter-active-line" style="top: 32px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">for i = 1:m,</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">   Perform forward propagation and backpropagation using example (x(i),y(i))</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">   (Get activations a(l) and delta terms d(l) for l = 2,...,L</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 370.019px; top: 32px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 48px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><h1>Bonus: Tutorial on How to classify your own images of digits </h1><p>This tutorial will guide you on how to use the classifier provided in exercise 3 to classify you own images like this:</p><p></p><figure><img src="https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/ACaeM3q8EeaTyQp_BD0w6w_48cf074e90214d540533308aa9dd4ab0_ML-Ex3-MyPhotoToDataDigit-4.jpg?expiry=1484524800000&amp;hmac=DKbXS3ABJZI9h3yLDtoCwKnbyA_IOy9O1hedEfCEf3M" alt="" data-asset-id="ACaeM3q8EeaTyQp_BD0w6w"></figure><h3>It will also explain how the images are converted thru several formats to be processed and displayed.</h3><h2>Introduction</h2><p>The classifier provided expects 20 x 20 pixels black and white images converted in a row vector of 400 real numbers like this</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 188.007px; top: 0px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_bracket ace_start ace_br15" style="height:16px;width:6.0003125px;top:0px;left:4px;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">[ 0.14532, 0.12876, ...]</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 148.007px; top: 0px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Each pixel is represented by a real number between -1.0 to 1.0, meaning -1.0 equal black and 1.0 equal white (any number in between is a shade of gray, and number 0.0 is exactly the middle gray).</p><p><strong>.jpg and color RGB images</strong></p><p>The most common image format that can be read by Octave is .jpg using function that outputs a three-dimensional matrix of integer numbers from 0 to 255, representing the height x width x 3 integers as indexes of a color map for each pixel (explaining color maps is beyond scope).</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 308.014px; top: 0px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Image3DmatrixRGB = imread("myOwnPhoto.jpg");</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 268.014px; top: 0px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><h3><strong>Convert to Black &amp; White</strong></h3><p>A common way to convert color images to black &amp; white, is to convert them to a YIQ standard and keep only the Y component that represents the luma information (black &amp; white). I and Q represent the chrominance information (color).Octave has a function <strong>rgb2ntsc()</strong> that outputs a similar three-dimensional matrix but of real numbers from -1.0 to 1.0, representing the height x width x 3 (Y luma, I in-phase, Q quadrature) intensity for each pixel.</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 284.012px; top: 0px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Image3DmatrixYIQ = rgb2ntsc(MyImageRGB);</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 244.012px; top: 0px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>To obtain the Black &amp; White component just discard the I and Q matrices. This leaves a two-dimensional matrix of real numbers from -1.0 to 1.0 representing the height x width pixels black &amp; white values.</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 296.013px; top: 0px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Image2DmatrixBW = Image3DmatrixYIQ(:,:,1);</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 256.013px; top: 0px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><h3><strong>Cropping to square image</strong></h3><p>It is useful to crop the original image to be as square as possible. The way to crop a matrix is by selecting an area inside the original B&amp;W image and copy it to a new matrix. This is done by selecting the rows and columns that define the area. In other words, it is copying a rectangular subset of the matrix like this:</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 16px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div></div><div class="ace_gutter-active-line" style="top: 16px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">croppedImage = Image2DmatrixBW(origen1:size1, origin2:size2);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 16px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 32px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Cropping does not have to be all the way to a square.<strong>It could be cropping just a percentage of the way to a square</strong>so you can leave more of the image intact. The next step of scaling will take care of streaching the image to fit a square.</p><h3><strong>Scaling to 20 x 20 pixels</strong></h3><p>The classifier provided was trained with 20 x 20 pixels images so we need to scale our photos to meet. It may cause distortion depending on the height and width ratio of the cropped original photo. There are many ways to scale a photo but we are going to use the simplest one. We lay a scaled grid of 20 x 20 over the original photo and take a sample pixel on the center of each grid. To lay a scaled grid, we compute two vectors of 20 indexes each evenly spaced on the original size of the image. One for the height and one for the width of the image. For example, in an image of 320 x 200 pixels will produce to vectors like</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 332.015px; top: 0px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">[9    25    41    57    73 ... 313] % 20 indexes</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 292.015px; top: 0px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 332.015px; top: 0px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">[6    16    26    36    46 ... 196] % 20 indexes</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 292.015px; top: 0px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Copy the value of each pixel located by the grid of these indexes to a new matrix. Ending up with a matrix of 20 x 20 real numbers.</p><h3><strong>Black &amp; White to Gray &amp; White</strong></h3><p>The classifier provided was trained with images of white digits over gray background. Specifically, the 20 x 20 matrix of real numbers ONLY range from 0.0 to 1.0 instead of the complete black &amp; white range of -1.0 to 1.0, this means that we have to normalize our photos to a range 0.0 to 1.0 for this classifier to work. But also, we invert the black and white colors because is easier to "draw" black over white on our photos and we need to get white digits. So in short, we <strong>invert black and white</strong> and <strong>stretch black to gray</strong>.</p><h3><strong>Rotation of image</strong></h3><p>Some times our photos are automatically rotated like in our celular phones. The classifier provided can not recognize rotated images so we may need to rotate it back sometimes. This can be done with an Octave function <strong>rot90()</strong> like this.</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 296.013px; top: 0px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">ImageAligned = rot90(Image, rotationStep);</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 256.013px; top: 0px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Where rotationStep is an integer: -1 mean rotate 90 degrees CCW and 1 mean rotate 90 degrees CW.</p><h2>Approach</h2><ol><li>The approach is to have a function that converts our photo to the format the classifier is expecting. As if it was just a sample from the training data set.</li><li>Use the classifier to predict the digit in the converted image.</li></ol><h2>Code step by step</h2><p>Define the function name, the output variable and three parameters, one for the filename of our photo, one optional cropping percentage (if not provided will default to zero, meaning no cropping) and the last optional rotation of the image (if not provided will default to cero, meaning no rotation).</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 16px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div></div><div class="ace_gutter-active-line" style="top: 16px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">function vectorImage = imageTo20x20Gray(fileName, cropPercentage=0, rotStep=0)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 16px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 32px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Read the file as a RGB image and convert it to Black &amp; White 2D matrix (see the introduction).</p><pre contenteditable="false" style="height: 130px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 112px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 160px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div></div><div class="ace_gutter-active-line" style="top: 112px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 160px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Read as RGB image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Image3DmatrixRGB = imread(fileName);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Convert to NTSC image (YIQ)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Image3DmatrixYIQ = rgb2ntsc(Image3DmatrixRGB );</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Convert to grays keeping only luminance (Y)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%        ...and discard chrominance (IQ)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Image2DmatrixBW  = Image3DmatrixYIQ(:,:,1);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 112px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 128px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Establish the final size of the cropped image.</p><pre contenteditable="false" style="height: 178px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 50px; top: 160px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 208px; width: 46px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div></div><div class="ace_gutter-active-line" style="top: 160px; height: 16px;"></div></div><div class="ace_scroller" style="left: 46px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 912px; height: 208px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Get the size of your image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">oldSize = size(Image2DmatrixBW);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Obtain crop size toward centered square (cropDelta)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% ...will be zero for the already minimum dimension</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% ...and if the cropPercentage is zero, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% ...both dimensions are zero</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% ...meaning that the original image will go intact to croppedImage</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">cropDelta = floor((oldSize - min(oldSize)) .* (cropPercentage/100));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute the desired final pixel size for the original image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">finalSize = oldSize - cropDelta;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 160px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 176px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 46px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 912px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Obtain the origin and amount of the columns and rows to be copied to the cropped image.</p><pre contenteditable="false" style="height: 130px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 112px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 160px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div></div><div class="ace_gutter-active-line" style="top: 112px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 160px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute each dimension origin for croping</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">cropOrigin = floor(cropDelta / 2) + 1;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute each dimension copying size</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">copySize = cropOrigin + finalSize - 1;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Copy just the desired cropped image from the original B&amp;W image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">croppedImage = Image2DmatrixBW( ...</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">                    cropOrigin(1):copySize(1), cropOrigin(2):copySize(2));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 112px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 128px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Compute the scale and compute back the new size. This last step is extra. It is computed back so the code keeps general for future modification of the classifier size. For example: if changed from 20 x 20 pixels to 30 x 30. Then the we only need to change the line of code where the scale is computed.</p><pre contenteditable="false" style="height: 82px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 64px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 112px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div></div><div class="ace_gutter-active-line" style="top: 64px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 112px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Resolution scale factors: [rows cols]</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">scale = [20 20] ./ finalSize;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute back the new image size (extra step to keep code general)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">newSize = max(floor(scale .* finalSize),1); </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 64px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 80px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Compute two sets of 20 indexes evenly spaced. One over the original height and one over the original width of the image.</p><pre contenteditable="false" style="height: 66px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 48px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 96px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div></div><div class="ace_gutter-active-line" style="top: 48px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 96px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute a re-sampled set of indices:</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">rowIndex = min(round(((1:newSize(1))-0.5)./scale(1)+0.5), finalSize(1));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">colIndex = min(round(((1:newSize(2))-0.5)./scale(2)+0.5), finalSize(2));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 48px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 64px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Copy just the indexed values from old image to get new image of 20 x 20 real numbers. This is called "sampling" because it copies just a sample pixel indexed by a grid. All the sample pixels make the new image.</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 32px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div></div><div class="ace_gutter-active-line" style="top: 32px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Copy just the indexed values from old image to get new image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">newImage = croppedImage(rowIndex,colIndex,:);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 32px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 48px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Rotate the matrix using the <strong>rot90()</strong> function with the rotStep parameter: -1 is CCW, 0 is no rotate, 1 is CW.</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 32px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div></div><div class="ace_gutter-active-line" style="top: 32px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Rotate if needed: -1 is CCW, 0 is no rotate, 1 is CW</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">newAlignedImage = rot90(newImage, rotStep);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 32px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 48px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Invert black and white because it is easier to draw black digits over white background in our photos but the classifier needs white digits.</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 32px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div></div><div class="ace_gutter-active-line" style="top: 32px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Invert black and white</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">invertedImage = - newAlignedImage;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 32px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 48px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Find the min and max gray values in the image and compute the total value range in preparation for normalization.</p><pre contenteditable="false" style="height: 98px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 80px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 128px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div></div><div class="ace_gutter-active-line" style="top: 80px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 128px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Find min and max grays values in the image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">maxValue = max(invertedImage(:));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">minValue = min(invertedImage(:));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute the value range of actual grays</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">delta = maxValue - minValue;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 80px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 96px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Do normalization so all values end up between 0.0 and 1.0 because this particular classifier do not perform well with negative numbers.</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 326.015px; top: 16px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div></div><div class="ace_gutter-active-line" style="top: 16px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Normalize grays between 0 and 1</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">normImage = (invertedImage - minValue) / delta;</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 286.015px; top: 16px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 32px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Add some contrast to the image. The multiplication factor is the contrast control, you can increase it if desired to obtain sharper contrast (contrast only between gray and white, black was already removed in normalization).</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 44px; top: 32px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div></div><div class="ace_gutter-active-line" style="top: 32px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Add contrast. Multiplication factor is contrast control.</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">contrastedImage = sigmoid((normImage -0.5) * 5);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 32px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 48px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Show the image specifying the black &amp; white range [-1 1] to avoid automatic ranging using the image range values of gray to white. Showing the photo with different range, does not affect the values in the output matrix, so do not affect the classifier. It is only as a visual feedback for the user.</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 248.011px; top: 16px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div></div><div class="ace_gutter-active-line" style="top: 16px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Show image as seen by the classifier</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">imshow(contrastedImage, [-1, 1] );</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 208.011px; top: 16px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 32px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Finally, output the matrix as a unrolled vector to be compatible with the classifier.</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 410.019px; top: 16px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div></div><div class="ace_gutter-active-line" style="top: 16px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Output the matrix as a unrolled vector</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">vectorImage = reshape(normImage, 1, newSize(1) * newSize(2));</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 370.019px; top: 16px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 32px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>End function.</p><pre contenteditable="false" style="height: 50px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 68.0012px; top: 0px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 80px; width: 40px;"><div class="ace_gutter-cell " style="height: 16px;">1</div></div><div class="ace_gutter-active-line" style="top: 0px; height: 16px;"></div></div><div class="ace_scroller" style="left: 40px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 918px; height: 80px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">end;</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 28.0012px; top: 0px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 16px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 918px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p></p><h2>Usage samples</h2><h3>Single photo</h3><ul><li>Photo file in myDigit.jpg</li><li>Cropping 60% of the way to square photo</li><li>No rotationvectorImage = imageTo20x20Gray('myDigit.jpg',60);
predict(Theta1, Theta2, vectorImage)</li><li>Photo file in myDigit.jpg</li><li>No cropping</li><li>CCW rotationvectorImage = imageTo20x20Gray('myDigit.jpg',:,-1);
predict(Theta1, Theta2, vectorImage)</li></ul><h3>Multiple photos</h3><ul><li>Photo files in myFirstDigit.jpg, mySecondDigit.jpg</li><li>First crop to square and second 25% of the way to square photo</li><li>First no rotation and second CW rotationvectorImage(1,:) = imageTo20x20Gray('myFirstDigit.jpg',100);
vectorImage(2,:) = imageTo20x20Gray('mySecondDigit.jpg',25,1);
predict(Theta1, Theta2, vectorImage)</li></ul><h2>Tips</h2><ul><li>JPG photos of black numbers over white background</li><li>Preferred square photos but not required</li><li>Rotate as needed because the classifier can only work with vertical digits</li><li>Leave background space around digit. Al least 2 pixels when seen at 20 x 20 resolution. This means that the classifier only really works in a 16 x 16 area.</li><li>Play changing the contrast multipier to 10 (or more).</li></ul><h2>Complete code (just copy and paste)</h2><p></p><pre contenteditable="false" style="height: 1154px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 68.0009px; top: 1136px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 1184px; width: 46px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div><div class="ace_gutter-cell " style="height: 16px;">12</div><div class="ace_gutter-cell " style="height: 16px;">13</div><div class="ace_gutter-cell " style="height: 16px;">14</div><div class="ace_gutter-cell " style="height: 16px;">15</div><div class="ace_gutter-cell " style="height: 16px;">16</div><div class="ace_gutter-cell " style="height: 16px;">17</div><div class="ace_gutter-cell " style="height: 16px;">18</div><div class="ace_gutter-cell " style="height: 16px;">19</div><div class="ace_gutter-cell " style="height: 16px;">20</div><div class="ace_gutter-cell " style="height: 16px;">21</div><div class="ace_gutter-cell " style="height: 16px;">22</div><div class="ace_gutter-cell " style="height: 16px;">23</div><div class="ace_gutter-cell " style="height: 16px;">24</div><div class="ace_gutter-cell " style="height: 16px;">25</div><div class="ace_gutter-cell " style="height: 16px;">26</div><div class="ace_gutter-cell " style="height: 16px;">27</div><div class="ace_gutter-cell " style="height: 16px;">28</div><div class="ace_gutter-cell " style="height: 16px;">29</div><div class="ace_gutter-cell " style="height: 16px;">30</div><div class="ace_gutter-cell " style="height: 16px;">31</div><div class="ace_gutter-cell " style="height: 16px;">32</div><div class="ace_gutter-cell " style="height: 16px;">33</div><div class="ace_gutter-cell " style="height: 16px;">34</div><div class="ace_gutter-cell " style="height: 16px;">35</div><div class="ace_gutter-cell " style="height: 16px;">36</div><div class="ace_gutter-cell " style="height: 16px;">37</div><div class="ace_gutter-cell " style="height: 16px;">38</div><div class="ace_gutter-cell " style="height: 16px;">39</div><div class="ace_gutter-cell " style="height: 16px;">40</div><div class="ace_gutter-cell " style="height: 16px;">41</div><div class="ace_gutter-cell " style="height: 16px;">42</div><div class="ace_gutter-cell " style="height: 16px;">43</div><div class="ace_gutter-cell " style="height: 16px;">44</div><div class="ace_gutter-cell " style="height: 16px;">45</div><div class="ace_gutter-cell " style="height: 16px;">46</div><div class="ace_gutter-cell " style="height: 16px;">47</div><div class="ace_gutter-cell " style="height: 16px;">48</div><div class="ace_gutter-cell " style="height: 16px;">49</div><div class="ace_gutter-cell " style="height: 16px;">50</div><div class="ace_gutter-cell " style="height: 16px;">51</div><div class="ace_gutter-cell " style="height: 16px;">52</div><div class="ace_gutter-cell " style="height: 16px;">53</div><div class="ace_gutter-cell " style="height: 16px;">54</div><div class="ace_gutter-cell " style="height: 16px;">55</div><div class="ace_gutter-cell " style="height: 16px;">56</div><div class="ace_gutter-cell " style="height: 16px;">57</div><div class="ace_gutter-cell " style="height: 16px;">58</div><div class="ace_gutter-cell " style="height: 16px;">59</div><div class="ace_gutter-cell " style="height: 16px;">60</div><div class="ace_gutter-cell " style="height: 16px;">61</div><div class="ace_gutter-cell " style="height: 16px;">62</div><div class="ace_gutter-cell " style="height: 16px;">63</div><div class="ace_gutter-cell " style="height: 16px;">64</div><div class="ace_gutter-cell " style="height: 16px;">65</div><div class="ace_gutter-cell " style="height: 16px;">66</div><div class="ace_gutter-cell " style="height: 16px;">67</div><div class="ace_gutter-cell " style="height: 16px;">68</div><div class="ace_gutter-cell " style="height: 16px;">69</div><div class="ace_gutter-cell " style="height: 16px;">70</div><div class="ace_gutter-cell " style="height: 16px;">71</div><div class="ace_gutter-cell " style="height: 16px;">72</div></div><div class="ace_gutter-active-line" style="top: 1136px; height: 16px;"></div></div><div class="ace_scroller" style="left: 46px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 912px; height: 1184px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">function vectorImage = imageTo20x20Gray(fileName, cropPercentage=0, rotStep=0)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%IMAGETO20X20GRAY display reduced image and converts for digit classification</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Sample usage: </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%       imageTo20x20Gray('myDigit.jpg', 100, -1);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%       First parameter: Image file name</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%             Could be bigger than 20 x 20 px, it will</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%             be resized to 20 x 20. Better if used with</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%             square images but not required.</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%       Second parameter: cropPercentage (any number between 0 and 100)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%             0  0% will be cropped (optional, no needed for square images)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%            50  50% of available croping will be cropped</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%           100  crop all the way to square image (for rectangular images)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%       Third parameter: rotStep</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%            -1  rotate image 90 degrees CCW</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%             0  do not rotate (optional)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%             1  rotate image 90 degrees CW</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">%</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% (Thanks to Edwin Frühwirth for parts of this code)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Read as RGB image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Image3DmatrixRGB = imread(fileName);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Convert to NTSC image (YIQ)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Image3DmatrixYIQ = rgb2ntsc(Image3DmatrixRGB );</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Convert to grays keeping only luminance (Y) and discard chrominance (IQ)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">Image2DmatrixBW  = Image3DmatrixYIQ(:,:,1);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Get the size of your image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">oldSize = size(Image2DmatrixBW);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Obtain crop size toward centered square (cropDelta)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% ...will be zero for the already minimum dimension</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% ...and if the cropPercentage is zero, </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% ...both dimensions are zero</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% ...meaning that the original image will go intact to croppedImage</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">cropDelta = floor((oldSize - min(oldSize)) .* (cropPercentage/100));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute the desired final pixel size for the original image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">finalSize = oldSize - cropDelta;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute each dimension origin for croping</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">cropOrigin = floor(cropDelta / 2) + 1;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute each dimension copying size</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">copySize = cropOrigin + finalSize - 1;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Copy just the desired cropped image from the original B&amp;W image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">croppedImage = Image2DmatrixBW( ...</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">                    cropOrigin(1):copySize(1), cropOrigin(2):copySize(2));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Resolution scale factors: [rows cols]</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">scale = [20 20] ./ finalSize;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute back the new image size (extra step to keep code general)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">newSize = max(floor(scale .* finalSize),1); </div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute a re-sampled set of indices:</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">rowIndex = min(round(((1:newSize(1))-0.5)./scale(1)+0.5), finalSize(1));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">colIndex = min(round(((1:newSize(2))-0.5)./scale(2)+0.5), finalSize(2));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Copy just the indexed values from old image to get new image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">newImage = croppedImage(rowIndex,colIndex,:);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Rotate if needed: -1 is CCW, 0 is no rotate, 1 is CW</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">newAlignedImage = rot90(newImage, rotStep);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Invert black and white</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">invertedImage = - newAlignedImage;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Find min and max grays values in the image</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">maxValue = max(invertedImage(:));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">minValue = min(invertedImage(:));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Compute the value range of actual grays</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">delta = maxValue - minValue;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Normalize grays between 0 and 1</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">normImage = (invertedImage - minValue) / delta;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Add contrast. Multiplication factor is contrast control.</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">contrastedImage = sigmoid((normImage -0.5) * 5);</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Show image as seen by the classifier</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">imshow(contrastedImage, [-1, 1] );</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% Output the matrix as a unrolled vector</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">vectorImage = reshape(contrastedImage, 1, newSize(1)*newSize(2));</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">end</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 22.0009px; top: 1136px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 1152px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 46px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 912px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><h2>Photo Gallery</h2><h3>Digit 2</h3><figure><img src="https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/CiREznq_Eead-BJkoDOYOw_2c6ef6611383b708e3a4a9b2fe93e292_ML-Ex3-MyPhotoToDataDigit-2.jpg?expiry=1484524800000&amp;hmac=vo3cXzzz00jQqmF2XHp3Rcn88l6J3O3bSVmnaxP-PEY" alt="" data-asset-id="CiREznq_Eead-BJkoDOYOw"></figure><h3><strong>Digit 6</strong></h3><figure><img src="https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/KA9DrHq_EeaTyQp_BD0w6w_e642a6104be729110862bfb46ac48673_ML-Ex3-MyPhotoToDataDigit-6.jpg?expiry=1484524800000&amp;hmac=hsljWSGwkowuqYeiMbFjBXMp0FocBTGSFjAsTlqmZBE" alt="" data-asset-id="KA9DrHq_EeaTyQp_BD0w6w"></figure><h3>Digit 6 inverted is digit 9. This is the same photo of a six but rotated. Also, changed the contrast multiplier from 5 to 20. You can note that the gray background is smoother.</h3><p></p><figure><img src="https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/S4L2cHtREead-BJkoDOYOw_3ab7938d6b6dbfbd9d3f8fcbde41b730_ML-Ex3-MyPhotoToDataDigit-9.jpg?expiry=1484524800000&amp;hmac=24EzXksM1_JtjMCCoxIiyeql4WK9Z3NrpNc9Ierq_Vc" alt="" data-asset-id="S4L2cHtREead-BJkoDOYOw"></figure><h3><strong>Digit 3</strong></h3><p></p><figure><img src="https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/R23Gv3tSEeaxYA6oVw19Xw_e2fce3219f3c9c316cbf43b1de41cd03_ML-Ex3-MyPhotoToDataDigit-3.jpg?expiry=1484524800000&amp;hmac=tWuD3WN-1E1dH94KfljBifRF5Rlpqk52ujNgqsIX9iA" alt="" data-asset-id="R23Gv3tSEeaxYA6oVw19Xw"></figure><h1>Explanation of Derivatives Used in Backpropagation</h1><ul><li>We know that for a logistic regression classifier (which is what all of the output neurons in a neural network are), we use the cost function, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1043-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32502"><span style="display: inline-block; position: relative; width: 305px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.1px 17360px 50.6px -9.1px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32503"><span class="mi" id="MathJax-Span-32504" style="font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-32505" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32506" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32507" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32508" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-32509" style="font-family: STIXGeneral; padding-left: 5.4px;">−</span><span class="mi" id="MathJax-Span-32510" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mi" id="MathJax-Span-32511" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mi" id="MathJax-Span-32512" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-32513" style="font-family: STIXGeneral; font-style: italic;">g</span><span class="mo" id="MathJax-Span-32514" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-32515"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32516" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="texatom" id="MathJax-Span-32517"><span class="mrow" id="MathJax-Span-32518"><span class="mi" id="MathJax-Span-32519" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32520" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32521" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-32522" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32523" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32524" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mo" id="MathJax-Span-32525" style="font-family: STIXGeneral; padding-left: 4.3px;">(</span><span class="mn" id="MathJax-Span-32526" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32527" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-32528" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">y</span><span class="mo" id="MathJax-Span-32529" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-32530" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mi" id="MathJax-Span-32531" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-32532" style="font-family: STIXGeneral; font-style: italic;">g</span><span class="mo" id="MathJax-Span-32533" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-32534" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32535" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-32536" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32537" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="texatom" id="MathJax-Span-32538"><span class="mrow" id="MathJax-Span-32539"><span class="mi" id="MathJax-Span-32540" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32541" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32542" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-32543" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-32544" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.4px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1043">J(\theta) = -ylog(h_{\theta}(x)) - (1-y)log(1-h_{\theta}(x))</script>, and apply this over the K output neurons, and for all m examples.</li><li>The equation to compute the partial derivatives of the theta terms in the output neurons:</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1044-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32545"><span style="display: inline-block; position: relative; width: 172px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32546"><span class="mfrac" id="MathJax-Span-32547" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-32548"><span class="mi" id="MathJax-Span-32549" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-32550" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-32551" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32552" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32553" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-32554"><span class="mi" id="MathJax-Span-32555" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32556"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32557" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-32558"><span class="mrow" id="MathJax-Span-32559"><span class="mo" id="MathJax-Span-32560" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32561" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32562" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32563" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32564" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-32565" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mfrac" id="MathJax-Span-32566" style="padding-left: 7.5px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 28.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-32567"><span class="mi" id="MathJax-Span-32568" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-32569" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-32570" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32571" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32572" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-32573"><span class="mi" id="MathJax-Span-32574" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32575"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32576" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32577"><span class="mrow" id="MathJax-Span-32578"><span class="mo" id="MathJax-Span-32579" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32580" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32581" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 28.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32582" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 26.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-32583"><span class="mi" id="MathJax-Span-32584" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32585"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32586" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32587"><span class="mrow" id="MathJax-Span-32588"><span class="mo" id="MathJax-Span-32589" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32590" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32591" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-32592"><span class="mi" id="MathJax-Span-32593" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32594"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32595" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32596"><span class="mrow" id="MathJax-Span-32597"><span class="mo" id="MathJax-Span-32598" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32599" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32600" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 26.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32601" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-32602"><span class="mi" id="MathJax-Span-32603" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32604"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32605" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32606"><span class="mrow" id="MathJax-Span-32607"><span class="mo" id="MathJax-Span-32608" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32609" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32610" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-32611"><span class="mi" id="MathJax-Span-32612" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32613"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32614" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-32615"><span class="mrow" id="MathJax-Span-32616"><span class="mo" id="MathJax-Span-32617" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32618" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32619" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32620" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32621" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 30.1px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1044">\frac{\partial J(\theta)}{\partial \theta^{(L-1)}} = \frac{\partial J(\theta)}{\partial a^{(L)}} \frac{\partial a^{(L)}}{\partial z^{(L)}} \frac{\partial z^{(L)}}{\partial \theta^{(L-1)}}</script></li><li>And the equation to compute partial derivatives of the theta terms in the [last] hidden layer neurons (layer L-1):</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1045-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32622"><span style="display: inline-block; position: relative; width: 258px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32623"><span class="mfrac" id="MathJax-Span-32624" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-32625"><span class="mi" id="MathJax-Span-32626" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-32627" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-32628" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32629" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32630" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-32631"><span class="mi" id="MathJax-Span-32632" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32633"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32634" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-32635"><span class="mrow" id="MathJax-Span-32636"><span class="mo" id="MathJax-Span-32637" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32638" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32639" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32640" style="font-size: 50%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-32641" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-32642" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mfrac" id="MathJax-Span-32643" style="padding-left: 7.5px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 28.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-32644"><span class="mi" id="MathJax-Span-32645" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-32646" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-32647" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32648" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32649" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-32650"><span class="mi" id="MathJax-Span-32651" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32652"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32653" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32654"><span class="mrow" id="MathJax-Span-32655"><span class="mo" id="MathJax-Span-32656" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32657" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32658" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 28.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32659" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 26.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-32660"><span class="mi" id="MathJax-Span-32661" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32662"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32663" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32664"><span class="mrow" id="MathJax-Span-32665"><span class="mo" id="MathJax-Span-32666" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32667" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32668" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-32669"><span class="mi" id="MathJax-Span-32670" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32671"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32672" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32673"><span class="mrow" id="MathJax-Span-32674"><span class="mo" id="MathJax-Span-32675" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32676" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32677" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 26.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32678" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-32679"><span class="mi" id="MathJax-Span-32680" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32681"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32682" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32683"><span class="mrow" id="MathJax-Span-32684"><span class="mo" id="MathJax-Span-32685" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32686" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32687" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-32688"><span class="mi" id="MathJax-Span-32689" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32690"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32691" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32692"><span class="mrow" id="MathJax-Span-32693"><span class="mo" id="MathJax-Span-32694" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32695" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32696" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32697" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32698" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32699" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-32700"><span class="mi" id="MathJax-Span-32701" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32702"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32703" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32704"><span class="mrow" id="MathJax-Span-32705"><span class="mo" id="MathJax-Span-32706" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32707" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32708" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32709" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32710" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -16.5px;"><span class="mrow" id="MathJax-Span-32711"><span class="mi" id="MathJax-Span-32712" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32713"><span style="display: inline-block; position: relative; width: 26.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32714" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32715"><span class="mrow" id="MathJax-Span-32716"><span class="mo" id="MathJax-Span-32717" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32718" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32719" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32720" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32721" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32722" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -16.5px;"><span class="mrow" id="MathJax-Span-32723"><span class="mi" id="MathJax-Span-32724" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32725"><span style="display: inline-block; position: relative; width: 26.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32726" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32727"><span class="mrow" id="MathJax-Span-32728"><span class="mo" id="MathJax-Span-32729" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32730" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32731" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32732" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32733" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-32734"><span class="mi" id="MathJax-Span-32735" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32736"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32737" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-32738"><span class="mrow" id="MathJax-Span-32739"><span class="mo" id="MathJax-Span-32740" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32741" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32742" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32743" style="font-size: 50%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-32744" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 30.1px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1045">\frac{\partial J(\theta)}{\partial \theta^{(L-2)}} = \frac{\partial J(\theta)}{\partial a^{(L)}} \frac{\partial a^{(L)}}{\partial z^{(L)}} \frac{\partial z^{(L)}}{\partial a^{(L-1)}} \frac{\partial a^{(L-1)}}{\partial z^{(L-1)}} \frac{\partial z^{(L-1)}}{\partial \theta^{(L-2)}}</script></li><li>Clearly they share some pieces in common, so a delta term (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1046-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32745"><span style="display: inline-block; position: relative; width: 25px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.6px 17360px 44.2px -8.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-32746"><span class="msubsup" id="MathJax-Span-32747"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-32748"><span class="mrow" id="MathJax-Span-32749"><span class="mo" id="MathJax-Span-32750" style="font-family: STIXGeneral;">δ</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.1px; left: 9px;"><span class="texatom" id="MathJax-Span-32751"><span class="mrow" id="MathJax-Span-32752"><span class="mo" id="MathJax-Span-32753" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32754" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32755" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.6px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1046">δ^{(L)}</script>) can be used for the common pieces between the output layer and the hidden layer immediately before it (with the possibility that there could be many hidden layers if we wanted):</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1047-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32756"><span style="display: inline-block; position: relative; width: 111px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.2px 17360px 56px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32757"><span class="msubsup" id="MathJax-Span-32758"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32759" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-32760"><span class="mrow" id="MathJax-Span-32761"><span class="mo" id="MathJax-Span-32762" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32763" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32764" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32765" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mfrac" id="MathJax-Span-32766" style="padding-left: 7.5px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 28.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-32767"><span class="mi" id="MathJax-Span-32768" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-32769" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-32770" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32771" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32772" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-32773"><span class="mi" id="MathJax-Span-32774" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32775"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32776" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32777"><span class="mrow" id="MathJax-Span-32778"><span class="mo" id="MathJax-Span-32779" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32780" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32781" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 28.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32782" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 26.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-32783"><span class="mi" id="MathJax-Span-32784" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32785"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32786" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32787"><span class="mrow" id="MathJax-Span-32788"><span class="mo" id="MathJax-Span-32789" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32790" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32791" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-32792"><span class="mi" id="MathJax-Span-32793" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32794"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32795" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32796"><span class="mrow" id="MathJax-Span-32797"><span class="mo" id="MathJax-Span-32798" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32799" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32800" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 26.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 28.7px; vertical-align: -10px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1047">\delta^{(L)} = \frac{\partial J(\theta)}{\partial a^{(L)}} \frac{\partial a^{(L)}}{\partial z^{(L)}}</script></li><li>And we can go ahead and use another delta term (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1048-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32801"><span style="display: inline-block; position: relative; width: 39px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.6px 17360px 44.2px -8.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-32802"><span class="msubsup" id="MathJax-Span-32803"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-32804"><span class="mrow" id="MathJax-Span-32805"><span class="mo" id="MathJax-Span-32806" style="font-family: STIXGeneral;">δ</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.1px; left: 9px;"><span class="texatom" id="MathJax-Span-32807"><span class="mrow" id="MathJax-Span-32808"><span class="mo" id="MathJax-Span-32809" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32810" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32811" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32812" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32813" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.6px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1048">δ^{(L−1)}</script>) for the pieces that would be shared by the final hidden layer and a hidden layer before that, if we had one. Regardless, this delta term will still serve to make the math and implementation more concise.</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1049-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32814"><span style="display: inline-block; position: relative; width: 212px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32815"><span class="msubsup" id="MathJax-Span-32816"><span style="display: inline-block; position: relative; width: 38.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32817" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-32818"><span class="mrow" id="MathJax-Span-32819"><span class="mo" id="MathJax-Span-32820" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32821" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32822" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32823" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32824" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32825" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mfrac" id="MathJax-Span-32826" style="padding-left: 7.5px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 28.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-32827"><span class="mi" id="MathJax-Span-32828" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-32829" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-32830" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32831" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32832" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-32833"><span class="mi" id="MathJax-Span-32834" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32835"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32836" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32837"><span class="mrow" id="MathJax-Span-32838"><span class="mo" id="MathJax-Span-32839" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32840" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32841" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 28.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32842" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 26.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-32843"><span class="mi" id="MathJax-Span-32844" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32845"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32846" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32847"><span class="mrow" id="MathJax-Span-32848"><span class="mo" id="MathJax-Span-32849" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32850" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32851" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-32852"><span class="mi" id="MathJax-Span-32853" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32854"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32855" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32856"><span class="mrow" id="MathJax-Span-32857"><span class="mo" id="MathJax-Span-32858" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32859" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32860" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 26.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32861" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-32862"><span class="mi" id="MathJax-Span-32863" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32864"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32865" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32866"><span class="mrow" id="MathJax-Span-32867"><span class="mo" id="MathJax-Span-32868" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32869" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32870" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-32871"><span class="mi" id="MathJax-Span-32872" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32873"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32874" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32875"><span class="mrow" id="MathJax-Span-32876"><span class="mo" id="MathJax-Span-32877" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32878" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32879" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32880" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32881" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32882" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-32883"><span class="mi" id="MathJax-Span-32884" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32885"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32886" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32887"><span class="mrow" id="MathJax-Span-32888"><span class="mo" id="MathJax-Span-32889" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32890" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32891" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32892" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32893" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -16.5px;"><span class="mrow" id="MathJax-Span-32894"><span class="mi" id="MathJax-Span-32895" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32896"><span style="display: inline-block; position: relative; width: 26.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32897" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32898"><span class="mrow" id="MathJax-Span-32899"><span class="mo" id="MathJax-Span-32900" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32901" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32902" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32903" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32904" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 29.6px; vertical-align: -10px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1049">\delta^{(L-1)} = \frac{\partial J(\theta)}{\partial a^{(L)}} \frac{\partial a^{(L)}}{\partial z^{(L)}} \frac{\partial z^{(L)}}{\partial a^{(L-1)}} \frac{\partial a^{(L-1)}}{\partial z^{(L-1)}}</script></li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1050-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32905"><span style="display: inline-block; position: relative; width: 171px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32906"><span class="msubsup" id="MathJax-Span-32907"><span style="display: inline-block; position: relative; width: 38.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32908" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-32909"><span class="mrow" id="MathJax-Span-32910"><span class="mo" id="MathJax-Span-32911" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32912" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32913" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32914" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32915" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-32916" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-32917" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32918" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-32919"><span class="mrow" id="MathJax-Span-32920"><span class="mo" id="MathJax-Span-32921" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32922" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32923" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32924" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-32925"><span class="mi" id="MathJax-Span-32926" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32927"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32928" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32929"><span class="mrow" id="MathJax-Span-32930"><span class="mo" id="MathJax-Span-32931" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32932" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32933" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-32934"><span class="mi" id="MathJax-Span-32935" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32936"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32937" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32938"><span class="mrow" id="MathJax-Span-32939"><span class="mo" id="MathJax-Span-32940" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32941" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32942" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32943" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32944" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32945" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-32946"><span class="mi" id="MathJax-Span-32947" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32948"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32949" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-32950"><span class="mrow" id="MathJax-Span-32951"><span class="mo" id="MathJax-Span-32952" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32953" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32954" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32955" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32956" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -16.5px;"><span class="mrow" id="MathJax-Span-32957"><span class="mi" id="MathJax-Span-32958" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32959"><span style="display: inline-block; position: relative; width: 26.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32960" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-32961"><span class="mrow" id="MathJax-Span-32962"><span class="mo" id="MathJax-Span-32963" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32964" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32965" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32966" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32967" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 29.6px; vertical-align: -10px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1050">\delta^{(L-1)} = \delta^{(L)} \frac{\partial z^{(L)}}{\partial a^{(L-1)}} \frac{\partial a^{(L-1)}}{\partial z^{(L-1)}}</script></li><li>With these delta terms, our equations become:</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1051-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-32968"><span style="display: inline-block; position: relative; width: 131px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-32969"><span class="mfrac" id="MathJax-Span-32970" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-32971"><span class="mi" id="MathJax-Span-32972" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-32973" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-32974" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32975" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-32976" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-32977"><span class="mi" id="MathJax-Span-32978" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32979"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-32980" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-32981"><span class="mrow" id="MathJax-Span-32982"><span class="mo" id="MathJax-Span-32983" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32984" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32985" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-32986" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-32987" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-32988" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-32989" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-32990" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-32991"><span class="mrow" id="MathJax-Span-32992"><span class="mo" id="MathJax-Span-32993" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-32994" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-32995" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-32996" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-32997"><span class="mi" id="MathJax-Span-32998" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-32999"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33000" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33001"><span class="mrow" id="MathJax-Span-33002"><span class="mo" id="MathJax-Span-33003" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33004" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33005" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33006"><span class="mi" id="MathJax-Span-33007" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33008"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33009" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33010"><span class="mrow" id="MathJax-Span-33011"><span class="mo" id="MathJax-Span-33012" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33013" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33014" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33015" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33016" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 30.1px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1051">\frac{\partial J(\theta)}{\partial \theta^{(L-1)}} = \delta^{(L)} \frac{\partial z^{(L)}}{\partial \theta^{(L-1)}}</script></li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1052-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33017"><span style="display: inline-block; position: relative; width: 145px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33018"><span class="mfrac" id="MathJax-Span-33019" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-33020"><span class="mi" id="MathJax-Span-33021" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-33022" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-33023" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33024" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-33025" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33026"><span class="mi" id="MathJax-Span-33027" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33028"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33029" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33030"><span class="mrow" id="MathJax-Span-33031"><span class="mo" id="MathJax-Span-33032" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33033" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33034" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33035" style="font-size: 50%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-33036" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33037" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33038" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 38.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33039" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33040"><span class="mrow" id="MathJax-Span-33041"><span class="mo" id="MathJax-Span-33042" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33043" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33044" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33045" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33046" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-33047" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -16.5px;"><span class="mrow" id="MathJax-Span-33048"><span class="mi" id="MathJax-Span-33049" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33050"><span style="display: inline-block; position: relative; width: 26.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33051" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33052"><span class="mrow" id="MathJax-Span-33053"><span class="mo" id="MathJax-Span-33054" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33055" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33056" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33057" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33058" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33059"><span class="mi" id="MathJax-Span-33060" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33061"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33062" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33063"><span class="mrow" id="MathJax-Span-33064"><span class="mo" id="MathJax-Span-33065" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33066" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33067" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33068" style="font-size: 50%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-33069" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 30.1px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1052">\frac{\partial J(\theta)}{\partial \theta^{(L-2)}} = \delta^{(L-1)} \frac{\partial z^{(L-1)}}{\partial \theta^{(L-2)}}</script></li><li>Now, time to evaluate these derivatives:</li><li>Let's start with the output layer:</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1053-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33070"><span style="display: inline-block; position: relative; width: 131px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33071"><span class="mfrac" id="MathJax-Span-33072" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-33073"><span class="mi" id="MathJax-Span-33074" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-33075" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-33076" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33077" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-33078" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33079"><span class="mi" id="MathJax-Span-33080" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33081"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33082" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33083"><span class="mrow" id="MathJax-Span-33084"><span class="mo" id="MathJax-Span-33085" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33086" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33087" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33088" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33089" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33090" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33091" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33092" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33093"><span class="mrow" id="MathJax-Span-33094"><span class="mo" id="MathJax-Span-33095" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33096" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33097" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-33098" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-33099"><span class="mi" id="MathJax-Span-33100" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33101"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33102" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33103"><span class="mrow" id="MathJax-Span-33104"><span class="mo" id="MathJax-Span-33105" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33106" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33107" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33108"><span class="mi" id="MathJax-Span-33109" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33110"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33111" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33112"><span class="mrow" id="MathJax-Span-33113"><span class="mo" id="MathJax-Span-33114" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33115" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33116" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33117" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33118" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 30.1px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1053">\frac{\partial J(\theta)}{\partial \theta^{(L-1)}} = \delta^{(L)} \frac{\partial z^{(L)}}{\partial \theta^{(L-1)}}</script></li><li>Using <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1054-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33119"><span style="display: inline-block; position: relative; width: 111px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.2px 17360px 56px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33120"><span class="msubsup" id="MathJax-Span-33121"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33122" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33123"><span class="mrow" id="MathJax-Span-33124"><span class="mo" id="MathJax-Span-33125" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33126" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33127" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33128" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mfrac" id="MathJax-Span-33129" style="padding-left: 7.5px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 28.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-33130"><span class="mi" id="MathJax-Span-33131" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-33132" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-33133" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33134" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-33135" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-33136"><span class="mi" id="MathJax-Span-33137" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33138"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33139" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33140"><span class="mrow" id="MathJax-Span-33141"><span class="mo" id="MathJax-Span-33142" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33143" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33144" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 28.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-33145" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 26.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-33146"><span class="mi" id="MathJax-Span-33147" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33148"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33149" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33150"><span class="mrow" id="MathJax-Span-33151"><span class="mo" id="MathJax-Span-33152" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33153" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33154" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-33155"><span class="mi" id="MathJax-Span-33156" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33157"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33158" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33159"><span class="mrow" id="MathJax-Span-33160"><span class="mo" id="MathJax-Span-33161" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33162" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33163" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 26.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 28.7px; vertical-align: -10px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1054">\delta^{(L)} = \frac{\partial J(\theta)}{\partial a^{(L)}} \frac{\partial a^{(L)}}{\partial z^{(L)}}</script>, we need to evaluate both partial derivatives.</li><li>Given <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1055-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33164"><span style="display: inline-block; position: relative; width: 284px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 50.6px -9.1px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33165"><span class="mi" id="MathJax-Span-33166" style="font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-33167" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33168" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-33169" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-33170" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-33171" style="font-family: STIXGeneral; padding-left: 5.4px;">−</span><span class="mi" id="MathJax-Span-33172" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mi" id="MathJax-Span-33173" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mi" id="MathJax-Span-33174" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-33175" style="font-family: STIXGeneral; font-style: italic;">g</span><span class="mo" id="MathJax-Span-33176" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-33177"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33178" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33179"><span class="mrow" id="MathJax-Span-33180"><span class="mo" id="MathJax-Span-33181" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33182" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33183" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33184" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-33185" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mo" id="MathJax-Span-33186" style="font-family: STIXGeneral; padding-left: 4.3px;">(</span><span class="mn" id="MathJax-Span-33187" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33188" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-33189" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">y</span><span class="mo" id="MathJax-Span-33190" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-33191" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mi" id="MathJax-Span-33192" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-33193" style="font-family: STIXGeneral; font-style: italic;">g</span><span class="mo" id="MathJax-Span-33194" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33195" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33196" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-33197" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33198" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33199"><span class="mrow" id="MathJax-Span-33200"><span class="mo" id="MathJax-Span-33201" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33202" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33203" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33204" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.2px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1055">J(\theta) = -ylog(a^{(L)}) - (1-y)log(1-a^{(L)})</script>, where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1056-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33205"><span style="display: inline-block; position: relative; width: 89px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 50.1px -8.7px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33206"><span class="msubsup" id="MathJax-Span-33207"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33208" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33209"><span class="mrow" id="MathJax-Span-33210"><span class="mo" id="MathJax-Span-33211" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33212" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33213" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33214" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33215" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33216" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="texatom" id="MathJax-Span-33217"><span class="mrow" id="MathJax-Span-33218"><span class="mi" id="MathJax-Span-33219" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33220" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33221" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-33222" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-33223" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 19.7px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1056">a^{(L)} = h_{\theta}(x))</script>, the partial derivative is:</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1057-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33224"><span style="display: inline-block; position: relative; width: 136px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.9px 17360px 55.1px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33225"><span class="mfrac" id="MathJax-Span-33226" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 28.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-33227"><span class="mi" id="MathJax-Span-33228" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-33229" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-33230" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33231" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-33232" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-33233"><span class="mi" id="MathJax-Span-33234" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33235"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33236" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33237"><span class="mrow" id="MathJax-Span-33238"><span class="mo" id="MathJax-Span-33239" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33240" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33241" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 28.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33242" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mfrac" id="MathJax-Span-33243" style="padding-left: 7.5px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 34.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.5px -7.6px); top: -51.8px; left: 50%; margin-left: -10px;"><span class="mrow" id="MathJax-Span-33244"><span class="mn" id="MathJax-Span-33245" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33246" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-33247" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -7.6px); top: -34px; left: 50%; margin-left: -16px;"><span class="mrow" id="MathJax-Span-33248"><span class="mn" id="MathJax-Span-33249" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33250" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="msubsup" id="MathJax-Span-33251"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33252" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33253"><span class="mrow" id="MathJax-Span-33254"><span class="mo" id="MathJax-Span-33255" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33256" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33257" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 34.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33258" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mfrac" id="MathJax-Span-33259" style="padding-left: 6.4px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 20px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.5px -9.3px); top: -51.8px; left: 50%; margin-left: -2.5px;"><span class="mi" id="MathJax-Span-33260" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(56.6px 17360px 72.1px -8.8px); top: -61px; left: 50%; margin-left: -9px;"><span class="msubsup" id="MathJax-Span-33261"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33262" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33263"><span class="mrow" id="MathJax-Span-33264"><span class="mo" id="MathJax-Span-33265" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33266" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33267" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 20px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 28.2px; vertical-align: -9.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1057">\frac{\partial J(\theta)}{\partial a^{(L)}} = \frac{1-y}{1-a^{(L)}} - \frac{y}{a^{(L)}}</script></li><li>And given a=g(z), where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1058-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33268"><span style="display: inline-block; position: relative; width: 66px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.4px 17360px 54.4px -8.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33269"><span class="mi" id="MathJax-Span-33270" style="font-family: STIXGeneral; font-style: italic;">g</span><span class="mo" id="MathJax-Span-33271" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mfrac" id="MathJax-Span-33272" style="padding-left: 7.5px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 31.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45px -7.6px); top: -49.3px; left: 50%; margin-left: -3px;"><span class="mn" id="MathJax-Span-33273" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45.5px -7.6px); top: -35.1px; left: 50%; margin-left: -14.5px;"><span class="mrow" id="MathJax-Span-33274"><span class="mn" id="MathJax-Span-33275" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33276" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="msubsup" id="MathJax-Span-33277"><span style="display: inline-block; position: relative; width: 14.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.6px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33278" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33279"><span class="mrow" id="MathJax-Span-33280"><span class="mo" id="MathJax-Span-33281" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-33282" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 31.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 24.9px; vertical-align: -8.4px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1058">g = \frac{1}{1+e^{-z}}</script>, the partial derivative is:</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1059-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33283"><span style="display: inline-block; position: relative; width: 143px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.3px 17360px 56px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33284"><span class="mfrac" id="MathJax-Span-33285" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 26.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-33286"><span class="mi" id="MathJax-Span-33287" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33288"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33289" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33290"><span class="mrow" id="MathJax-Span-33291"><span class="mo" id="MathJax-Span-33292" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33293" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33294" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-33295"><span class="mi" id="MathJax-Span-33296" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33297"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33298" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33299"><span class="mrow" id="MathJax-Span-33300"><span class="mo" id="MathJax-Span-33301" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33302" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33303" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 26.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33304" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33305" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33306" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33307"><span class="mrow" id="MathJax-Span-33308"><span class="mo" id="MathJax-Span-33309" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33310" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33311" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33312" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33313" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33314" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-33315" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33316" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33317"><span class="mrow" id="MathJax-Span-33318"><span class="mo" id="MathJax-Span-33319" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33320" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33321" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33322" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 28.7px; vertical-align: -10px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1059">\frac{\partial a^{(L)}}{\partial z^{(L)}} = a^{(L)}(1-a^{(L)})</script></li><li>So, let's substitute these in for <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1060-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33323"><span style="display: inline-block; position: relative; width: 25px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.6px 17360px 44.2px -8.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-33324"><span class="msubsup" id="MathJax-Span-33325"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-33326"><span class="mrow" id="MathJax-Span-33327"><span class="mo" id="MathJax-Span-33328" style="font-family: STIXGeneral;">δ</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.1px; left: 9px;"><span class="texatom" id="MathJax-Span-33329"><span class="mrow" id="MathJax-Span-33330"><span class="mo" id="MathJax-Span-33331" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33332" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33333" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.6px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1060">δ^{(L)}</script>:</li></ul><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1061-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33334"><span style="display: inline-block; position: relative; width: 111px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.2px 17360px 56px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33335"><span class="msubsup" id="MathJax-Span-33336"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33337" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33338"><span class="mrow" id="MathJax-Span-33339"><span class="mo" id="MathJax-Span-33340" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33341" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33342" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33343" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mfrac" id="MathJax-Span-33344" style="padding-left: 7.5px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 28.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-33345"><span class="mi" id="MathJax-Span-33346" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-33347" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-33348" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33349" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-33350" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-33351"><span class="mi" id="MathJax-Span-33352" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33353"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33354" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33355"><span class="mrow" id="MathJax-Span-33356"><span class="mo" id="MathJax-Span-33357" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33358" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33359" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 28.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-33360" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 26.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -12px;"><span class="mrow" id="MathJax-Span-33361"><span class="mi" id="MathJax-Span-33362" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33363"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33364" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33365"><span class="mrow" id="MathJax-Span-33366"><span class="mo" id="MathJax-Span-33367" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33368" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33369" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-33370"><span class="mi" id="MathJax-Span-33371" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33372"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33373" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33374"><span class="mrow" id="MathJax-Span-33375"><span class="mo" id="MathJax-Span-33376" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33377" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33378" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 26.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 28.7px; vertical-align: -10px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1061">\delta^{(L)} = \frac{\partial J(\theta)}{\partial a^{(L)}} \frac{\partial a^{(L)}}{\partial z^{(L)}}</script></p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1062-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33379"><span style="display: inline-block; position: relative; width: 242px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.9px 17360px 55.1px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33380"><span class="msubsup" id="MathJax-Span-33381"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33382" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33383"><span class="mrow" id="MathJax-Span-33384"><span class="mo" id="MathJax-Span-33385" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33386" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33387" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33388" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-33389" style="font-family: STIXGeneral; padding-left: 5.4px;">(</span><span class="mfrac" id="MathJax-Span-33390" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 34.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.5px -7.6px); top: -51.8px; left: 50%; margin-left: -10px;"><span class="mrow" id="MathJax-Span-33391"><span class="mn" id="MathJax-Span-33392" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33393" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-33394" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -7.6px); top: -34px; left: 50%; margin-left: -16px;"><span class="mrow" id="MathJax-Span-33395"><span class="mn" id="MathJax-Span-33396" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33397" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="msubsup" id="MathJax-Span-33398"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33399" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33400"><span class="mrow" id="MathJax-Span-33401"><span class="mo" id="MathJax-Span-33402" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33403" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33404" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 34.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33405" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mfrac" id="MathJax-Span-33406" style="padding-left: 6.4px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 20px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.5px -9.3px); top: -51.8px; left: 50%; margin-left: -2.5px;"><span class="mi" id="MathJax-Span-33407" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(56.6px 17360px 72.1px -8.8px); top: -61px; left: 50%; margin-left: -9px;"><span class="msubsup" id="MathJax-Span-33408"><span style="display: inline-block; position: relative; width: 17.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33409" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33410"><span class="mrow" id="MathJax-Span-33411"><span class="mo" id="MathJax-Span-33412" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33413" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33414" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 20px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33415" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-33416" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-33417"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33418" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33419"><span class="mrow" id="MathJax-Span-33420"><span class="mo" id="MathJax-Span-33421" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33422" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33423" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33424" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33425" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33426" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-33427" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33428" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33429"><span class="mrow" id="MathJax-Span-33430"><span class="mo" id="MathJax-Span-33431" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33432" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33433" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33434" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-33435" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 28.2px; vertical-align: -9.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1062">\delta^{(L)} = (\frac{1-y}{1-a^{(L)}} - \frac{y}{a^{(L)}}) (a^{(L)}(1-a^{(L)}))</script></p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1063-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33436"><span style="display: inline-block; position: relative; width: 99px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.8px 17360px 50.6px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33437"><span class="msubsup" id="MathJax-Span-33438"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33439" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33440"><span class="mrow" id="MathJax-Span-33441"><span class="mo" id="MathJax-Span-33442" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33443" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33444" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33445" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33446" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33447" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33448"><span class="mrow" id="MathJax-Span-33449"><span class="mo" id="MathJax-Span-33450" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33451" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33452" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33453" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-33454" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">y</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.7px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1063">\delta^{(L)} =a^{(L)} - y</script></p><ul><li>So, for a 3-layer network (L=3),</li></ul><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1064-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33455"><span style="display: inline-block; position: relative; width: 97px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.8px 17360px 50.6px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33456"><span class="msubsup" id="MathJax-Span-33457"><span style="display: inline-block; position: relative; width: 23.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33458" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33459"><span class="mrow" id="MathJax-Span-33460"><span class="mo" id="MathJax-Span-33461" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33462" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span class="mo" id="MathJax-Span-33463" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33464" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33465" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33466" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33467"><span class="mrow" id="MathJax-Span-33468"><span class="mo" id="MathJax-Span-33469" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33470" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span class="mo" id="MathJax-Span-33471" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33472" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-33473" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">y</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.7px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1064">\delta^{(3)} =a^{(3)} - y</script></p><ul><li>Note that this is the correct equation, as given in our notes.</li><li>Now, given z=θ∗input, and in layer L the input is <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1065-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33474"><span style="display: inline-block; position: relative; width: 39px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.4px 17360px 44.2px -8.7px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-33475"><span class="msubsup" id="MathJax-Span-33476"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33477" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33478"><span class="mrow" id="MathJax-Span-33479"><span class="mo" id="MathJax-Span-33480" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33481" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33482" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33483" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33484" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1065">a^{(L−1)}</script>, the partial derivative is:</li></ul><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1066-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33485"><span style="display: inline-block; position: relative; width: 102px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33486"><span class="mfrac" id="MathJax-Span-33487" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-33488"><span class="mi" id="MathJax-Span-33489" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33490"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33491" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33492"><span class="mrow" id="MathJax-Span-33493"><span class="mo" id="MathJax-Span-33494" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33495" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33496" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33497"><span class="mi" id="MathJax-Span-33498" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33499"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33500" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33501"><span class="mrow" id="MathJax-Span-33502"><span class="mo" id="MathJax-Span-33503" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33504" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33505" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33506" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33507" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33508" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33509" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33510" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33511"><span class="mrow" id="MathJax-Span-33512"><span class="mo" id="MathJax-Span-33513" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33514" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33515" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33516" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33517" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 30.1px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1066">\frac{\partial z^{(L)}}{\partial \theta^{(L-1)}} = a^{(L-1)}</script></p><ul><li><strong>Put it together for the output layer</strong>:</li></ul><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1067-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33518"><span style="display: inline-block; position: relative; width: 131px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33519"><span class="mfrac" id="MathJax-Span-33520" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-33521"><span class="mi" id="MathJax-Span-33522" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-33523" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-33524" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33525" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-33526" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33527"><span class="mi" id="MathJax-Span-33528" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33529"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33530" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33531"><span class="mrow" id="MathJax-Span-33532"><span class="mo" id="MathJax-Span-33533" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33534" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33535" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33536" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33537" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33538" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33539" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33540" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33541"><span class="mrow" id="MathJax-Span-33542"><span class="mo" id="MathJax-Span-33543" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33544" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33545" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-33546" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-33547"><span class="mi" id="MathJax-Span-33548" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33549"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33550" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33551"><span class="mrow" id="MathJax-Span-33552"><span class="mo" id="MathJax-Span-33553" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33554" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33555" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33556"><span class="mi" id="MathJax-Span-33557" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33558"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33559" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33560"><span class="mrow" id="MathJax-Span-33561"><span class="mo" id="MathJax-Span-33562" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33563" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33564" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33565" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33566" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 30.1px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1067">\frac{\partial J(\theta)}{\partial \theta^{(L-1)}} = \delta^{(L)} \frac{\partial z^{(L)}}{\partial \theta^{(L-1)}}</script></p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1068-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33567"><span style="display: inline-block; position: relative; width: 178px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.2px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33568"><span class="mfrac" id="MathJax-Span-33569" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-33570"><span class="mi" id="MathJax-Span-33571" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-33572" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-33573" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33574" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-33575" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33576"><span class="mi" id="MathJax-Span-33577" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33578"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33579" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33580"><span class="mrow" id="MathJax-Span-33581"><span class="mo" id="MathJax-Span-33582" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33583" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33584" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33585" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33586" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33587" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-33588" style="font-family: STIXGeneral; padding-left: 5.4px;">(</span><span class="msubsup" id="MathJax-Span-33589"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33590" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33591"><span class="mrow" id="MathJax-Span-33592"><span class="mo" id="MathJax-Span-33593" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33594" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33595" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33596" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-33597" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">y</span><span class="mo" id="MathJax-Span-33598" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-33599" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-33600"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33601" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33602"><span class="mrow" id="MathJax-Span-33603"><span class="mo" id="MathJax-Span-33604" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33605" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33606" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33607" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33608" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33609" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 29.3px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1068">\frac{\partial J(\theta)}{\partial \theta^{(L-1)}} = (a^{(L)} - y) (a^{(L-1)})</script></p><ul><li>Let's continue on for the hidden layer (let's assume we only have 1 hidden layer):</li></ul><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1069-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33610"><span style="display: inline-block; position: relative; width: 145px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33611"><span class="mfrac" id="MathJax-Span-33612" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-33613"><span class="mi" id="MathJax-Span-33614" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-33615" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-33616" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33617" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-33618" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33619"><span class="mi" id="MathJax-Span-33620" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33621"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33622" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33623"><span class="mrow" id="MathJax-Span-33624"><span class="mo" id="MathJax-Span-33625" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33626" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33627" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33628" style="font-size: 50%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-33629" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33630" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33631" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 38.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33632" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33633"><span class="mrow" id="MathJax-Span-33634"><span class="mo" id="MathJax-Span-33635" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33636" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33637" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33638" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33639" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-33640" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -16.5px;"><span class="mrow" id="MathJax-Span-33641"><span class="mi" id="MathJax-Span-33642" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33643"><span style="display: inline-block; position: relative; width: 26.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33644" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33645"><span class="mrow" id="MathJax-Span-33646"><span class="mo" id="MathJax-Span-33647" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33648" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33649" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33650" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33651" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33652"><span class="mi" id="MathJax-Span-33653" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33654"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33655" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33656"><span class="mrow" id="MathJax-Span-33657"><span class="mo" id="MathJax-Span-33658" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33659" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33660" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33661" style="font-size: 50%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-33662" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 30.1px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1069">\frac{\partial J(\theta)}{\partial \theta^{(L-2)}} =  \delta^{(L-1)} \frac{\partial z^{(L-1)}}{\partial \theta^{(L-2)}}</script></p><ul><li>Let's figure out <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1070-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33663"><span style="display: inline-block; position: relative; width: 59px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.1px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33664"><span class="texatom" id="MathJax-Span-33665"><span class="mrow" id="MathJax-Span-33666"><span class="mo" id="MathJax-Span-33667" style="font-family: STIXGeneral;">δ</span></span></span><span class="texatom" id="MathJax-Span-33668"><span class="mrow" id="MathJax-Span-33669"><span class="mo" id="MathJax-Span-33670" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33671" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-33672" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mn" id="MathJax-Span-33673" style="font-family: STIXGeneral; padding-left: 4.3px;">1</span><span class="mo" id="MathJax-Span-33674" style="font-family: STIXGeneral;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.9px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1070">δ{(L−1)}</script>.</li><li>Once again, given z=θ∗input, the partial derivative is:</li></ul><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1071-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33675"><span style="display: inline-block; position: relative; width: 102px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 55.1px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33676"><span class="mfrac" id="MathJax-Span-33677" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-33678"><span class="mi" id="MathJax-Span-33679" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33680"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33681" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33682"><span class="mrow" id="MathJax-Span-33683"><span class="mo" id="MathJax-Span-33684" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33685" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33686" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-33687"><span class="mi" id="MathJax-Span-33688" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33689"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33690" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33691"><span class="mrow" id="MathJax-Span-33692"><span class="mo" id="MathJax-Span-33693" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33694" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33695" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33696" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33697" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33698" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33699" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 40.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33700" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-33701"><span class="mrow" id="MathJax-Span-33702"><span class="mo" id="MathJax-Span-33703" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33704" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33705" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33706" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33707" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 28.7px; vertical-align: -9.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1071">\frac{\partial z^{(L)}}{\partial a^{(L-1)}} = \theta^{(L-1)}</script></p><ul><li>And: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1072-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33708"><span style="display: inline-block; position: relative; width: 181px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.3px 17360px 56px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33709"><span class="mfrac" id="MathJax-Span-33710" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-33711"><span class="mi" id="MathJax-Span-33712" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33713"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33714" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33715"><span class="mrow" id="MathJax-Span-33716"><span class="mo" id="MathJax-Span-33717" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33718" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33719" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33720" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33721" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -16.5px;"><span class="mrow" id="MathJax-Span-33722"><span class="mi" id="MathJax-Span-33723" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33724"><span style="display: inline-block; position: relative; width: 26.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33725" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33726"><span class="mrow" id="MathJax-Span-33727"><span class="mo" id="MathJax-Span-33728" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33729" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33730" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33731" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33732" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33733" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33734" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33735" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33736"><span class="mrow" id="MathJax-Span-33737"><span class="mo" id="MathJax-Span-33738" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33739" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33740" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33741" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33742" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33743" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33744" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33745" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-33746" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33747" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33748"><span class="mrow" id="MathJax-Span-33749"><span class="mo" id="MathJax-Span-33750" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33751" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33752" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33753" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33754" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33755" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 28.7px; vertical-align: -10px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1072">\frac{\partial a^{(L-1)}}{\partial z^{(L-1)}} = a^{(L-1)}(1-a^{(L-1)})</script></li><li>So, let's substitute these in for <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1073-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33756"><span style="display: inline-block; position: relative; width: 39px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.6px 17360px 44.2px -8.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-33757"><span class="msubsup" id="MathJax-Span-33758"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(29.1px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-33759"><span class="mrow" id="MathJax-Span-33760"><span class="mo" id="MathJax-Span-33761" style="font-family: STIXGeneral;">δ</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.1px; left: 9px;"><span class="texatom" id="MathJax-Span-33762"><span class="mrow" id="MathJax-Span-33763"><span class="mo" id="MathJax-Span-33764" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33765" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33766" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33767" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33768" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.6px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1073">δ^{(L−1)}</script>:</li></ul><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1074-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33769"><span style="display: inline-block; position: relative; width: 171px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33770"><span class="msubsup" id="MathJax-Span-33771"><span style="display: inline-block; position: relative; width: 38.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33772" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33773"><span class="mrow" id="MathJax-Span-33774"><span class="mo" id="MathJax-Span-33775" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33776" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33777" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33778" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33779" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33780" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33781" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33782" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33783"><span class="mrow" id="MathJax-Span-33784"><span class="mo" id="MathJax-Span-33785" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33786" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33787" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-33788" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-33789"><span class="mi" id="MathJax-Span-33790" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33791"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33792" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33793"><span class="mrow" id="MathJax-Span-33794"><span class="mo" id="MathJax-Span-33795" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33796" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33797" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-33798"><span class="mi" id="MathJax-Span-33799" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33800"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33801" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33802"><span class="mrow" id="MathJax-Span-33803"><span class="mo" id="MathJax-Span-33804" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33805" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33806" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33807" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33808" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-33809" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-33810"><span class="mi" id="MathJax-Span-33811" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33812"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33813" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-33814"><span class="mrow" id="MathJax-Span-33815"><span class="mo" id="MathJax-Span-33816" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33817" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33818" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33819" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33820" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -16.5px;"><span class="mrow" id="MathJax-Span-33821"><span class="mi" id="MathJax-Span-33822" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33823"><span style="display: inline-block; position: relative; width: 26.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33824" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-33825"><span class="mrow" id="MathJax-Span-33826"><span class="mo" id="MathJax-Span-33827" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33828" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33829" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33830" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33831" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 29.6px; vertical-align: -10px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1074">\delta^{(L-1)} = \delta^{(L)} \frac{\partial z^{(L)}}{\partial a^{(L-1)}} \frac{\partial a^{(L-1)}}{\partial z^{(L-1)}}</script></p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1075-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33832"><span style="display: inline-block; position: relative; width: 266px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 50.1px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33833"><span class="msubsup" id="MathJax-Span-33834"><span style="display: inline-block; position: relative; width: 38.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33835" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33836"><span class="mrow" id="MathJax-Span-33837"><span class="mo" id="MathJax-Span-33838" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33839" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33840" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33841" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33842" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33843" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33844" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33845" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33846"><span class="mrow" id="MathJax-Span-33847"><span class="mo" id="MathJax-Span-33848" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33849" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33850" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33851" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-33852"><span style="display: inline-block; position: relative; width: 40.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33853" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-33854"><span class="mrow" id="MathJax-Span-33855"><span class="mo" id="MathJax-Span-33856" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33857" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33858" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33859" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33860" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33861" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-33862" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-33863"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33864" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33865"><span class="mrow" id="MathJax-Span-33866"><span class="mo" id="MathJax-Span-33867" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33868" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33869" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33870" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33871" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33872" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33873" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33874" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-33875" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33876" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33877"><span class="mrow" id="MathJax-Span-33878"><span class="mo" id="MathJax-Span-33879" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33880" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33881" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33882" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33883" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33884" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-33885" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.4px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1075">\delta^{(L-1)} = \delta^{(L)} (\theta^{(L-1)}) (a^{(L-1)}(1-a^{(L-1)}))</script></p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1076-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33886"><span style="display: inline-block; position: relative; width: 243px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 50.1px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33887"><span class="msubsup" id="MathJax-Span-33888"><span style="display: inline-block; position: relative; width: 38.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33889" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33890"><span class="mrow" id="MathJax-Span-33891"><span class="mo" id="MathJax-Span-33892" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33893" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33894" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33895" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33896" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33897" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33898" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33899" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33900"><span class="mrow" id="MathJax-Span-33901"><span class="mo" id="MathJax-Span-33902" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33903" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33904" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-33905"><span style="display: inline-block; position: relative; width: 40.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33906" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-33907"><span class="mrow" id="MathJax-Span-33908"><span class="mo" id="MathJax-Span-33909" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33910" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33911" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33912" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33913" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-33914"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33915" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33916"><span class="mrow" id="MathJax-Span-33917"><span class="mo" id="MathJax-Span-33918" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33919" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33920" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33921" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33922" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33923" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33924" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33925" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-33926" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33927" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33928"><span class="mrow" id="MathJax-Span-33929"><span class="mo" id="MathJax-Span-33930" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33931" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33932" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33933" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33934" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33935" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.4px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1076">\delta^{(L-1)} = \delta^{(L)} \theta^{(L-1)} a^{(L-1)}(1-a^{(L-1)})</script></p><ul><li>So, for a 3-layer network,</li></ul><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1077-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33936"><span style="display: inline-block; position: relative; width: 182px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 50.1px -8.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33937"><span class="msubsup" id="MathJax-Span-33938"><span style="display: inline-block; position: relative; width: 23.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33939" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33940"><span class="mrow" id="MathJax-Span-33941"><span class="mo" id="MathJax-Span-33942" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33943" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-33944" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33945" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33946" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 23.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33947" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-33948"><span class="mrow" id="MathJax-Span-33949"><span class="mo" id="MathJax-Span-33950" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33951" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span class="mo" id="MathJax-Span-33952" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-33953"><span style="display: inline-block; position: relative; width: 25.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33954" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-33955"><span class="mrow" id="MathJax-Span-33956"><span class="mo" id="MathJax-Span-33957" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33958" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-33959" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-33960"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33961" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33962"><span class="mrow" id="MathJax-Span-33963"><span class="mo" id="MathJax-Span-33964" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33965" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-33966" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33967" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33968" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-33969" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-33970" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-33971" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-33972"><span class="mrow" id="MathJax-Span-33973"><span class="mo" id="MathJax-Span-33974" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-33975" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-33976" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-33977" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.4px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1077">\delta^{(2)} = \delta^{(3)} \theta^{(2)} a^{(2)}(1-a^{(2)})</script></p><ul><li><strong>Put it together for the [last] hidden layer</strong>:</li></ul><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1078-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-33978"><span style="display: inline-block; position: relative; width: 145px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-33979"><span class="mfrac" id="MathJax-Span-33980" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-33981"><span class="mi" id="MathJax-Span-33982" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-33983" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-33984" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33985" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-33986" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-33987"><span class="mi" id="MathJax-Span-33988" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-33989"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-33990" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-33991"><span class="mrow" id="MathJax-Span-33992"><span class="mo" id="MathJax-Span-33993" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-33994" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-33995" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-33996" style="font-size: 50%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-33997" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-33998" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="msubsup" id="MathJax-Span-33999" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 38.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-34000" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-34001"><span class="mrow" id="MathJax-Span-34002"><span class="mo" id="MathJax-Span-34003" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34004" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34005" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34006" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-34007" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-34008" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -16.5px;"><span class="mrow" id="MathJax-Span-34009"><span class="mi" id="MathJax-Span-34010" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-34011"><span style="display: inline-block; position: relative; width: 26.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-34012" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-34013"><span class="mrow" id="MathJax-Span-34014"><span class="mo" id="MathJax-Span-34015" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34016" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34017" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34018" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-34019" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-34020"><span class="mi" id="MathJax-Span-34021" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-34022"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-34023" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-34024"><span class="mrow" id="MathJax-Span-34025"><span class="mo" id="MathJax-Span-34026" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34027" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34028" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34029" style="font-size: 50%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-34030" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 30.1px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1078">\frac{\partial J(\theta)}{\partial \theta^{(L-2)}} = \delta^{(L-1)} \frac{\partial z^{(L-1)}}{\partial \theta^{(L-2)}}</script></p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1079-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-34031"><span style="display: inline-block; position: relative; width: 236px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.4px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-34032"><span class="mfrac" id="MathJax-Span-34033" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-34034"><span class="mi" id="MathJax-Span-34035" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-34036" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-34037" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34038" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-34039" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-34040"><span class="mi" id="MathJax-Span-34041" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-34042"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-34043" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-34044"><span class="mrow" id="MathJax-Span-34045"><span class="mo" id="MathJax-Span-34046" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34047" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34048" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34049" style="font-size: 50%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-34050" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-34051" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-34052" style="font-family: STIXGeneral; padding-left: 5.4px;">(</span><span class="msubsup" id="MathJax-Span-34053"><span style="display: inline-block; position: relative; width: 24.3px; height: 0px;"><span style="position: absolute; clip: rect(29.4px 17360px 47.2px -8.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-34054" style="font-family: STIXGeneral; font-style: italic;">δ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.9px; left: 8px;"><span class="texatom" id="MathJax-Span-34055"><span class="mrow" id="MathJax-Span-34056"><span class="mo" id="MathJax-Span-34057" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34058" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34059" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-34060" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 46px -8.5px); top: -50.3px; left: 50%; margin-left: -11.5px;"><span class="mrow" id="MathJax-Span-34061"><span class="mi" id="MathJax-Span-34062" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-34063"><span style="display: inline-block; position: relative; width: 16.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-34064" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 5px;"><span class="texatom" id="MathJax-Span-34065"><span class="mrow" id="MathJax-Span-34066"><span class="mo" id="MathJax-Span-34067" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34068" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34069" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 45.1px -8.5px); top: -34px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-34070"><span class="mi" id="MathJax-Span-34071" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-34072"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-34073" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 6px;"><span class="texatom" id="MathJax-Span-34074"><span class="mrow" id="MathJax-Span-34075"><span class="mo" id="MathJax-Span-34076" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34077" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34078" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34079" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-34080" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mfrac" id="MathJax-Span-34081" style="padding-left: 5.3px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 36.1px; height: 0px;"><span style="position: absolute; clip: rect(28.7px 17360px 45.1px -8.5px); top: -49.4px; left: 50%; margin-left: -17px;"><span class="mrow" id="MathJax-Span-34082"><span class="mi" id="MathJax-Span-34083" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-34084"><span style="display: inline-block; position: relative; width: 27.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-34085" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -45.5px; left: 6px;"><span class="texatom" id="MathJax-Span-34086"><span class="mrow" id="MathJax-Span-34087"><span class="mo" id="MathJax-Span-34088" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34089" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34090" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34091" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-34092" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(29.6px 17360px 46px -8.5px); top: -34px; left: 50%; margin-left: -16.5px;"><span class="mrow" id="MathJax-Span-34093"><span class="mi" id="MathJax-Span-34094" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-34095"><span style="display: inline-block; position: relative; width: 26.9px; height: 0px;"><span style="position: absolute; clip: rect(33.7px 17360px 46px -9px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-34096" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5px;"><span class="texatom" id="MathJax-Span-34097"><span class="mrow" id="MathJax-Span-34098"><span class="mo" id="MathJax-Span-34099" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34100" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34101" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34102" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-34103" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 36.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-34104" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-34105" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-34106"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-34107" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-34108"><span class="mrow" id="MathJax-Span-34109"><span class="mo" id="MathJax-Span-34110" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34111" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34112" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34113" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-34114" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-34115" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 30.1px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1079">\frac{\partial J(\theta)}{\partial \theta^{(L-2)}} = (\delta^{(L)} \frac{\partial z^{(L)}}{\partial a^{(L-1)}} \frac{\partial a^{(L-1)}}{\partial z^{(L-1)}}) (a^{(L-2)})</script></p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1080-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-34116"><span style="display: inline-block; position: relative; width: 372px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.2px 17360px 56.6px -6.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-34117"><span class="mfrac" id="MathJax-Span-34118" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 37.1px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.5px); top: -51.4px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-34119"><span class="mi" id="MathJax-Span-34120" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-34121" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="mo" id="MathJax-Span-34122" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34123" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-34124" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(28.2px 17360px 45.1px -8.5px); top: -32.6px; left: 50%; margin-left: -17.5px;"><span class="mrow" id="MathJax-Span-34125"><span class="mi" id="MathJax-Span-34126" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="msubsup" id="MathJax-Span-34127"><span style="display: inline-block; position: relative; width: 28.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-34128" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-34129"><span class="mrow" id="MathJax-Span-34130"><span class="mo" id="MathJax-Span-34131" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34132" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34133" style="font-size: 50%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34134" style="font-size: 50%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-34135" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 37.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span><span class="mo" id="MathJax-Span-34136" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mo" id="MathJax-Span-34137" style="font-family: STIXGeneral; padding-left: 5.4px;">(</span><span class="mo" id="MathJax-Span-34138" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-34139"><span style="display: inline-block; position: relative; width: 25.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-34140" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-34141"><span class="mrow" id="MathJax-Span-34142"><span class="mo" id="MathJax-Span-34143" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34144" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34145" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-34146" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-34147" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">y</span><span class="mo" id="MathJax-Span-34148" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-34149" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-34150"><span style="display: inline-block; position: relative; width: 40.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-34151" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-34152"><span class="mrow" id="MathJax-Span-34153"><span class="mo" id="MathJax-Span-34154" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34155" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34156" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34157" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-34158" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-34159" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-34160" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-34161"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-34162" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-34163"><span class="mrow" id="MathJax-Span-34164"><span class="mo" id="MathJax-Span-34165" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34166" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34167" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34168" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-34169" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-34170" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-34171" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-34172" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-34173" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-34174" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-34175"><span class="mrow" id="MathJax-Span-34176"><span class="mo" id="MathJax-Span-34177" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34178" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34179" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34180" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-34181" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-34182" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-34183" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-34184" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-34185" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-34186"><span style="display: inline-block; position: relative; width: 39.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.7px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-34187" style="font-family: STIXGeneral; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="texatom" id="MathJax-Span-34188"><span class="mrow" id="MathJax-Span-34189"><span class="mo" id="MathJax-Span-34190" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34191" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-34192" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-34193" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-34194" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-34195" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 29.3px; vertical-align: -10.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1080">\frac{\partial J(\theta)}{\partial \theta^{(L-2)}} = ((a^{(L)} - y) (\theta^{(L-1)})(a^{(L-1)}(1-a^{(L-1)}))) (a^{(L-2)})</script></p><h1>NN for linear systems</h1><h2>Introduction</h2><p>The NN we created for classification can easily be modified to have a linear output. First solve the 4th programming exercise. You can create a new function script, nnCostFunctionLinear.m, with the following characteristics</p><ul><li>There is only one output node, so you do not need the 'num_labels' parameter.</li><li>Since there is one linear output, you do not need to convert y into a logical matrix.</li><li>You still need a non-linear function in the hidden layer.</li><li>The non-linear function is often the tanh() function - it has an output range from -1 to +1, and its gradient is easily implemented. Let g(z)=tanh(z).</li><li>The gradient of tanh is <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1081-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-34196"><span style="display: inline-block; position: relative; width: 118px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 50.6px -8.9px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-34197"><span class="msup" id="MathJax-Span-34198"><span style="display: inline-block; position: relative; width: 14.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -8.9px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-34199" style="font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 9px;"><span class="mo" id="MathJax-Span-34200" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-34201" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34202" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="mo" id="MathJax-Span-34203" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-34204" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mn" id="MathJax-Span-34205" style="font-family: STIXGeneral; padding-left: 5.4px;">1</span><span class="mo" id="MathJax-Span-34206" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-34207" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">g</span><span class="mo" id="MathJax-Span-34208" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-34209" style="font-family: STIXGeneral; font-style: italic;">z</span><span class="msubsup" id="MathJax-Span-34210"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-34211" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="mn" id="MathJax-Span-34212" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.9px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1081">g'(z) = 1 - g(z)^2</script>. Use this in backpropagation in place of the sigmoid gradient.</li><li>Remove the sigmoid function from the output layer (i.e. calculate a3 without using a sigmoid function), since we want a linear output.</li><li>Cost computation: Use the linear cost function for J (from ex1 and ex5) for the unregularized portion. For the regularized portion, use the same method as ex4.</li><li>Where reshape() is used to form the Theta matrices, replace 'num_labels' with '1'.</li></ul><p>You still need to randomly initialize the Theta values, just as with any NN. You will want to experiment with different epsilon values. You will also need to create a predictLinear() function, using the tanh() function in the hidden layer, and a linear output.</p><h2>Testing your linear NN</h2><p>Here is a test case for your nnCostFunctionLinear()</p><pre contenteditable="false" style="height: 450px; opacity: 1;" class=" ace_editor ace-tomorrow"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; left: 50px; top: 432px; height: 16px; width: 6.00031px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: 0px; height: 480px; width: 46px;"><div class="ace_gutter-cell " style="height: 16px;">1</div><div class="ace_gutter-cell " style="height: 16px;">2</div><div class="ace_gutter-cell " style="height: 16px;">3</div><div class="ace_gutter-cell " style="height: 16px;">4</div><div class="ace_gutter-cell " style="height: 16px;">5</div><div class="ace_gutter-cell " style="height: 16px;">6</div><div class="ace_gutter-cell " style="height: 16px;">7</div><div class="ace_gutter-cell " style="height: 16px;">8</div><div class="ace_gutter-cell " style="height: 16px;">9</div><div class="ace_gutter-cell " style="height: 16px;">10</div><div class="ace_gutter-cell " style="height: 16px;">11</div><div class="ace_gutter-cell " style="height: 16px;">12</div><div class="ace_gutter-cell " style="height: 16px;">13</div><div class="ace_gutter-cell " style="height: 16px;">14</div><div class="ace_gutter-cell " style="height: 16px;">15</div><div class="ace_gutter-cell " style="height: 16px;">16</div><div class="ace_gutter-cell " style="height: 16px;">17</div><div class="ace_gutter-cell " style="height: 16px;">18</div><div class="ace_gutter-cell " style="height: 16px;">19</div><div class="ace_gutter-cell " style="height: 16px;">20</div><div class="ace_gutter-cell " style="height: 16px;">21</div><div class="ace_gutter-cell " style="height: 16px;">22</div><div class="ace_gutter-cell " style="height: 16px;">23</div><div class="ace_gutter-cell " style="height: 16px;">24</div><div class="ace_gutter-cell " style="height: 16px;">25</div><div class="ace_gutter-cell " style="height: 16px;">26</div><div class="ace_gutter-cell " style="height: 16px;">27</div><div class="ace_gutter-cell " style="height: 16px;">28</div></div><div class="ace_gutter-active-line" style="top: 432px; height: 16px;"></div></div><div class="ace_scroller" style="left: 46px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: 0px; width: 912px; height: 480px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 484.025px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% inputs</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">nn_params = [31 16 15 -29 -13 -8 -7 13 54 -17 -11 -9 16]'/ 10;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">il = 1;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">hl = 4;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">X = [1; 2; 3];</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">y = [1; 4; 9];</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">lambda = 0.01;</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% command</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">[j g] = nnCostFunctionLinear(nn_params, il, hl, X, y, lambda)</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">% results</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">j =  0.020815</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">g =</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    -0.0131002</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    -0.0110085</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    -0.0070569</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">     0.0189212</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    -0.0189639</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    -0.0192539</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    -0.0102291</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">     0.0344732</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">     0.0024947</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">     0.0080624</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">     0.0021964</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">     0.0031675</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px">    -0.0064244</div></div><div class="ace_line_group" style="height:16px"><div class="ace_line" style="height:16px"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="left: 4px; top: 432px; width: 6.00031px; height: 16px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 448px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 20px; left: 46px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 20px; width: 912px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></pre><p>Now create a script that uses the 'ex5data1.mat' from ex5, but without creating the polynomial terms. With 8 units in the hidden layer and MaxIter set to 200, you should be able to get a final cost value of 0.3 to 0.4. The results will vary a bit due to the random Theta initialization. If you plot the training set and the predicted values for the training set (using your predictLinear() function), you should have a good match.</p><h1>Additional Resources for Backpropagation</h1><ul><li>Very thorough conceptual [example] (<a href="https://web.archive.org/web/20150317210621/https://www4.rgu.ac.uk/files/chapter3%20-%20bp.pdf" target="_blank" rel="noopener nofollow">https://web.archive.org/web/20150317210621/https://www4.rgu.ac.uk/files/chapter3%20-%20bp.pdf</a>) </li><li>Short derivation of the backpropagation algorithm: <a href="http://pandamatak.com/people/anand/771/html/node37.html" target="_blank" rel="noopener nofollow">http://pandamatak.com/people/anand/771/html/node37.html</a> </li><li>Stanford University Deep Learning notes: <a href="http://ufldl.stanford.edu/wiki/index.php/Backpropagation_Algorithm" target="_blank" rel="noopener nofollow">http://ufldl.stanford.edu/wiki/index.php/Backpropagation_Algorithm</a> </li><li>Very thorough explanation and proof:  <a href="http://neuralnetworksanddeeplearning.com/chap2.html" target="_blank" rel="noopener nofollow">http://neuralnetworksanddeeplearning.com/chap2.html</a> </li></ul><p></p></div></div></section></body></html>